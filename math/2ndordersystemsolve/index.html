<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Solving Second Order Systems of Differential Equations | smashmath</title> <meta name="author" content=" "> <meta name="description" content="ye"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/math/2ndordersystemsolve/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Solving Second Order Systems of Differential Equations</h1> <p class="post-description">ye</p> </header> <article> <p>This was mentioned in my <a href="../secondordersystems" target="_blank">post about constructing these kind of problems</a>, but the good news about these kind of problems is that is that when discussing \(n\times n\) second order systems such as</p> \[\begin{equation} \label{sys} x''+Px'+Qx=0 \end{equation}\] <p>we are still only really talking about a first order system. We can reduce any second order system to a first order by adding \(n\) more variables. So if \(x=(x_1,\ldots,x_n)\) then we let \(y=(x_1,\ldots,x_n,x_1',\ldots,x_n')\). Which gives us the system</p> \[\begin{equation} \label{reduction} y'=\begin{bmatrix} 0&amp;I\\-Q&amp;-P \end{bmatrix} y \end{equation}\] <p>So, <strong>for an \(n\times n\) system of second order differential equations, there will be \(2n\) linearly independent solutions.</strong></p> <p>In the \(2\times 2\) case, this tells us that the solutions to our \(2\times 2\) second order system can have all the behaviors of a \(4\times 4\) first order system. So we can have an eigenvalue repeated 4 times and get a \(t^3\) term in our homogeneous solutions, and if \(P,Q\) are real, then we can have up to two complex conjugate pairs of eigenvalues.</p> <p>At this point, there are two avenues to solve this problem using techniques you likely have already learned. A more standard one is to find a solution to \eqref{reduction},</p> \[y=c_1y_1(t)+\ldots+c_{2n}y_{2n}(t)\] <p>and then saying \(x_i(t)=\begin{bmatrix} I_n&amp;0 \end{bmatrix}y_i(t)\). In other words, only take the first \(n\) entries of the \(y\) solutions. Another would be</p> \[\begin{equation} \label{exp1} x=\begin{bmatrix} I_n&amp;0 \end{bmatrix} \exp\left(\begin{bmatrix} 0&amp;I\\-Q&amp;-P \end{bmatrix}t\right) \begin{bmatrix} x(0)\\x'(0) \end{bmatrix} \end{equation}\] <p>giving us a theoretical general solution. But computing large matrix exponentials is arguably harder than just finding the \(y\) solutions. But even just <em>computing</em> the characteristic polynomial of a \(4\times 4\) matrix can be a huge chore. Luckily, keeping it second order can actually make it easier. The computations are at least easier in my opinion, since the determinant one calculates is half as large. Especially since the computational power required for computing determinants increases factorially.</p> <p>I have developed an approach to these problems which is very similar to the way one solves linear second order differential equation. And the computations here are far less arduous, in my opinion.</p> <h2 id="the-characteristic-polynomial">The Characteristic Polynomial</h2> <p>Like most linear differential equations, we consider a characteristic polynomial, usually derived by supposing a solution of the form \(x=ce^{st}\). Substituting this into \eqref{sys} gives us</p> \[\begin{equation} \label{charpoly} (Is^2+Ps+Q)c=0 \end{equation}\] <p>We will denote \(L(s)=Is^2+Ps+Q\). We can then write \eqref{sys} as</p> \[L(D)x=0\] <p>where \(D\) is the differential operator such that \(Dx=x'\).</p> <p>If we want our solution to be nontrivial, we assume that \(c\neq 0\). Therefore, \(Is^2+Ps+Q\) must have a nontrivial null space. An alternative characterization is that</p> \[\begin{equation} \label{charpolydet} \det(Is^2+Ps+Q)=0 \end{equation}\] <p>We will denote \(p(s)=\det(Is^2+Ps+Q)\). Fun fact, this \(p(s)\) is the same characteristic polynomial of the matrix in \eqref{reduction}. This should be no surprise since the problems are equivalent .</p> <p>This will be a polynomial of degree \(2n\). So these problems become quite difficult quite quickly. Even just a \(2\times 2\) system requires solving a quartic polynomial, making it technically the largest system for which we can guarantee being able to find an exact solution. Once we get a \(3\times 3\), we no longer have a formula to solve the degree \(6\) polynomial. That said, the quartic formula is ridiculously unwieldy enough to make the case that unless you have some <a href="../secondordersystems" target="_blank">savvy techniques to guarantee these problems will have have nice solutions</a>, they are effectively unsolvable in the general case.</p> <p>Since these roots are the eigenvalues of the matrix in \eqref{reduction}, we will call them as such. Considering their algebraic and geometric multiplicity is also still indeed useful.</p> <h2 id="obtaining-solutions">Obtaining Solutions</h2> <p>Since \eqref{charpoly} is merely an \(n\times n\) matrix, if a root of the characteristic polynomial is repeated more than \(n\) times, then it is a clearly defective eigenvalue. More often, however, for a particular root of the characteristic polynomial \(s_i\), we obtain \(\operatorname{nullity}(L(s_i))=\operatorname{nullity}(Is_i^2+Ps_i+Q)\) linearly independent solutions vectors and pray that the number we get is equal to the algebraic multiplicity of the eigenvalue.</p> <p>To get solutions of the form \(x=ve^{s_it}\), solve the system</p> \[\begin{equation} \label{eigenvector} L(s_i)v=0 \end{equation}\] <h2 id="complex-eigenvalues-with-real-matrices">Complex Eigenvalues with Real Matrices</h2> <p>This is thankfully exactly the same as the first order case. If \(P\) and \(Q\) are real matrices.</p> <p>Suppose one eigenvalue is \(\lambda+i\mu\), where \(\lambda,\mu\in\mathbb{R}\). Then we merely need one complex eigenvector \(v\) such that \(L(\lambda+i\mu)v=0\). We will then get two linearly independent solutions</p> \[\begin{gather} x_1=\operatorname{Re}(e^{\lambda+i\mu}v)\\ x_2=\operatorname{Im}(e^{\lambda+i\mu}v) \end{gather}\] <h2 id="defective-eigenvalues">Defective Eigenvalues</h2> <p>Unfortunately, this is the case which is far more difficult than the first order version. I believe the following method, which is reminiscent of reduction of order, is the most efficient way to do it.</p> <p>So let us suppose we have a particular eigenvalue \(\lambda\) which has geometric multiplicity \(g\) and algebraic multiplicity \(g+m\) for \(m\geq 1\). Then we do a substitution</p> \[\begin{equation} x(t)=e^{\lambda t}v(t) \end{equation}\] <p>It can be verified that if we define</p> \[L'(s)=2Is+P\] <p>then \eqref{sys} can be simplified to</p> \[\begin{equation} \label{reductionoforder} v''+L'(\lambda)v'+L(\lambda)v=0 \end{equation}\] <p>We will call this the shifted equation, because this can be viewed from the lens of an exponential shift,</p> \[L(D)(e^{\lambda t}v)=e^{\lambda t}L(D+\lambda)v\] <p>and matches with the Taylor series of \(L(x)\) centered at \(\lambda\).</p> <p>To get the rest of the solutions associated with the eigenvalue \(\lambda\) from \eqref{reductionoforder}, we suppose a solution of the form</p> \[\begin{equation} v=c_0+c_1t+\ldots+c_mt^{m} \end{equation}\] <p>for vectors \(c_0,\ldots,c_m\). Substitute into \eqref{reductionoforder} and equate terms with the same power of \(t\). This means that \(c_m\) will be some linear combination of the eigenvectors associated with the eigenvalue.</p> <p>This is consistent with the Obtaining Solutions section, as if the algebraic multiplicity of the eigenvalue is only one, \eqref{reductionoforder} simplifies down to \eqref{eigenvector} \(L(\lambda)v=0\).</p> <p>As a tip, always include the homogeneous solution. That way you will get all \(m\) solutions from the eigenvalue.</p> <h2 id="a-remark-on-nonhomogeneous-systems">A remark on nonhomogeneous systems</h2> <p>I can’t see any better way to solve nonhomogeneous systems than reducing the equation to \eqref{reduction} and solving it as a nonhomogeneous first order system of equations. I haven’t experimented with it much, but I can only imagine the Method of Undetermined Coefficients being reasonable.</p> <h1 id="example">Example</h1> \[x''+\begin{bmatrix}2&amp;-2\\2&amp;4\end{bmatrix}x'+\begin{bmatrix}-2&amp;-4\\4&amp;4\end{bmatrix}x=0\] <p>This is a \(2\times 2\) system, so we expect \(4\) linearly independent solutions.</p> <p>To start, as with all linear constant coefficient differential equations, we examine the characteristic polynomial.</p> \[\begin{gather*} L(s)=Is^2+\begin{bmatrix}2&amp;-2\\2&amp;4\end{bmatrix}s+\begin{bmatrix}-2&amp;-4\\4&amp;4\end{bmatrix}\\ L(s)=\begin{bmatrix}s^2+2s-2&amp;-2(s+2)\\2(s+2)&amp;s^2+4s+4\end{bmatrix}\\ L(s)=\begin{bmatrix}s^2+2s-2&amp;-2(s+2)\\2(s+2)&amp;(s+2)^2\end{bmatrix}\\ p(s)=\begin{vmatrix}s^2+2s-2&amp;-2(s+2)\\2(s+2)&amp;(s+2)^2\end{vmatrix} \end{gather*}\] <p>We can use determinant properties to simplify things by dividing out \(s+2\) from the second column and second row.</p> \[\begin{gather*} p(s)=(s+2)^2\begin{vmatrix}s^2+2s-2&amp;-2\\2&amp;1\end{vmatrix}\\ p(s)=(s+2)^2(s^2+2s+2)\\ p(s)=(s+2)^2((s+1)^2+1)\\ \end{gather*}\] <p>The roots of \(p(s)\) appear to be \(s=-2,-1\pm i\). Unfortunately \(-2\) is repeated, but looks to only have one eigenvector. We also have a pair of complex conjugate eigenvalues.</p> <p>First, we can start by finding the regular eigenvector associated with \(s=-2\).</p> \[L(-2)=\begin{bmatrix}-2&amp;0\\0&amp;0\end{bmatrix}\] <p>An easy basis for the null space of this matrix would be \((0,1)\). Therefore, our first solution would be</p> \[x_1=\begin{bmatrix}0\\1\end{bmatrix}e^{-2t}\] <p>To get our second solution, we must examine the shifted equation. We definitely could have started with this and obtained both \(x_1\) and \(x_2\) at the same time, but I thought I would go through the standard procedure one goes through when finding a solution when the eigenvalue is not defective.</p> <p>We calculate that</p> \[L'(s)=\begin{bmatrix}2s+2&amp;-2\\2&amp;2(s+2)\end{bmatrix}\] <p>Which tells us that</p> \[L'(-2)=\begin{bmatrix}-2&amp;-2\\2&amp;0\end{bmatrix}\] <p>So if \(x=ve^{-2t}\), our shifted equation is</p> \[v''+\begin{bmatrix}-2&amp;-2\\2&amp;0\end{bmatrix}v'+\begin{bmatrix}-2&amp;0\\0&amp;0\end{bmatrix}v=0\] <p>The difference between our algebraic and geometric multiplicity is only \(1\), so we suppose our solution for our \(-2\) eigenvalue is</p> \[v=c_0+c_1t\] <p>Telling us that \(v'=c_1\) and \(v''=0\).</p> <p>Substituting in,</p> \[\begin{bmatrix}-2&amp;-2\\2&amp;0\end{bmatrix}c_1+\begin{bmatrix}-2&amp;0\\0&amp;0\end{bmatrix}(c_0+c_1t)=0\] <p>Since all terms must be zero, we can separate the different power of \(t\) into different equations. This gives us two equations,</p> \[\begin{gather*} \begin{bmatrix}-2&amp;0\\0&amp;0\end{bmatrix}c_1=0\\ \begin{bmatrix}-2&amp;-2\\2&amp;0\end{bmatrix}c_1+\begin{bmatrix}-2&amp;0\\0&amp;0\end{bmatrix}c_0=0 \end{gather*}\] <p>The first equation is very easy. \(c_1=k_1\begin{bmatrix}0\\1\end{bmatrix}\) (oh hey it’s our eigenvector, what a coincidence). Substituting this into the second equation, dividing out the two common to both matrices, and moving the \(c_0\) matrix to the other side of the equation gives us</p> \[\begin{bmatrix}1&amp;0\\0&amp;0\end{bmatrix}c_0=\begin{bmatrix}k_1\\0\end{bmatrix}c_1\] <p>So \(c_0=\begin{bmatrix}k_1\\0\end{bmatrix}+k_0\begin{bmatrix}0\\1\end{bmatrix}\). Therefore,</p> \[v=k_0\begin{bmatrix}0\\1\end{bmatrix}+k_1\begin{bmatrix}1\\t\end{bmatrix}\] <p>Giving us two solutions</p> \[x=k_0\begin{bmatrix}0\\1\end{bmatrix}e^{-2t}+k_1\begin{bmatrix}1\\t\end{bmatrix}e^{-2t}\] <p>The first term is just \(x_1\), so we get our second solution</p> \[x_2=\begin{bmatrix}1\\t\end{bmatrix}e^{-2t}\] <p>We will get our last two solutions from our last two eigenvalues \(s=-1\pm i\). Since these matrices are real, we only need one complex eigenvector, and that will give us two solutions.</p> <p>So examining \(L(-1+i)\),</p> \[L(-1+i)=\begin{bmatrix}-4&amp;-2-2i\\2+2i&amp;2i\end{bmatrix}\] <p>It can be confirmed that this matrix is singular, and a basis for the null space is \((1,-1+i)\).</p> <p>So now we just need to look at the real and imaginary parts of</p> \[\begin{bmatrix}1\\-1+i\end{bmatrix}e^{(-1+i)t}\] <p>Which are</p> \[\begin{gather*} x_3=\begin{bmatrix}\cos t\\-\cos t-\sin t\end{bmatrix}e^{-t}\\ x_4=\begin{bmatrix}\sin t\\\cos t-\sin t\end{bmatrix}e^{-t} \end{gather*}\] <p>Making our general solution</p> \[x=c_1\begin{bmatrix}0\\1\end{bmatrix}e^{-2t}+c_2\begin{bmatrix}1\\t\end{bmatrix}e^{-2t}+c_3\begin{bmatrix}\cos t\\-\cos t-\sin t\end{bmatrix}e^{-t}+c_4\begin{bmatrix}\sin t\\\cos t-\sin t\end{bmatrix}e^{-t}\] </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: September 26, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>