<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Variation of Parameters Using Linear Algebra | smashmath</title> <meta name="author" content=" "> <meta name="description" content="linear is best frend :)"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/math/voplinear/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Variation of Parameters Using Linear Algebra</h1> <p class="post-description">linear is best frend :)</p> </header> <article> <p>Consider the differential equation</p> \[\begin{equation} y''+p(t)y'+q(t)y=f(t) \end{equation}\] <p>Given two linearly independent homogeneous solutions \(y_1(t),y_2(t)\), we wish to find the general solution. To do this, we are going to reduce this second order linear nonhomogeneous differential equation into a system of first order linear nonhomogeneous differential equations.</p> <p>We let \(x(t)=(x_1(t),x_2(t))=(y(t),y'(t))\).</p> \[\begin{align} x_1(t)=y(t)&amp;&amp;x_2(t)=&amp;y'(t)\\ x_1'(t)=y'(t)&amp;&amp;x_2'(t)=&amp;y''(t)\\ &amp;&amp;x_2'(t)=&amp;-q(t)y(t)-p(t)y'(t)+f(t)\\ x_1'(t)=x_2(t)&amp;&amp;x_2'(t)=&amp;-q(t)x_1(t)-p(t)x_2(t)+f(t) \end{align}\] <p>Then we reduce the original differential equation into</p> \[\begin{equation} x'(t)=\begin{bmatrix}0&amp;1\\-q(t)&amp;-p(t)\end{bmatrix}x(t)+\begin{bmatrix}0\\f(t)\end{bmatrix} \end{equation}\] <p>If we define</p> \[A(t)=\begin{bmatrix}0&amp;1\\-q(t)&amp;-p(t)\end{bmatrix},\quad g(t)=\begin{bmatrix}0\\f(t)\end{bmatrix}\] <p>it becomes</p> \[\begin{equation} x'(t)=A(t)x(t)+g(t) \end{equation}\] <p>One can confirm that two linearly independent homogeneous solutions are \(x^{(1)}(t)=\begin{bmatrix}y_1(t)\\y_1'(t)\end{bmatrix},\quad x^{(2)}(t)=\begin{bmatrix}y_2(t)\\y_2'(t)\end{bmatrix}\)</p> <p>based on the assumption that \(y_1,y_2\) are solutions to the original differential equation.</p> <p>We then have a <em>fundamental matrix</em> \(\Psi(t)=\begin{bmatrix}x^{(1)}(t)&amp;x^{(2)}(t)\end{bmatrix}\)</p> \[\begin{equation} \Psi(t)=\begin{bmatrix}y_1(t)&amp;y_2(t)\\y_1'(t)&amp;y_2'(t)\end{bmatrix} \end{equation}\] <p>We call this a fundamental matrix because it is an invertible matrix (at least for some point \(t=t_0\)) that has the nifty property that</p> \[\begin{equation} \Psi'(t)=A(t)\Psi(t) \end{equation}\] <p>Now we define the vector \(u(t)=(u_1(t),u_2(t))\) for some unknown functions \(u_1(t),u_2(t)\), and suppose that the general solution to the system is</p> \[\begin{equation} x(t)=\Psi(t)u(t) \end{equation}\] \[\begin{bmatrix}x_1(t)\\x_2(t)\end{bmatrix}=\begin{bmatrix}y_1(t)&amp;y_2(t)\\y_1'(t)&amp;y_2'(t)\end{bmatrix}\begin{bmatrix}u_1(t)\\u_2(t)\end{bmatrix}\] <p>Since the solution to our original differential equation is \(y(t)=x_1(t)\), this equation tells us that</p> \[\begin{equation} y(t)=y_1(t)u_1(t)+y_2(t)u_2(t) \end{equation}\] <p>Which is exactly what we suppose the solution is when doing variation of parameters!</p> <p>Take the derivative of \(x(t)\),</p> \[x'(t)=\Psi'(t)u(t)+\Psi(t)u'(t)\] <p>We can simplify the first term using our nifty property,</p> \[x'(t)=A(t)\Psi(t)u(t)+\Psi(t)u'(t)\] \[x'(t)=A(t)x(t)+\Psi(t)u'(t)\] <p>Since \(x'(t)=A(t)x(t)+g(t)\), clearly we need</p> \[\Psi(t)u'(t)=g(t)\] \[\begin{bmatrix}y_1(t)&amp;y_2(t)\\y_1'(t)&amp;y_2'(t)\end{bmatrix}\begin{bmatrix}u_1'(t)\\u_2'(t)\end{bmatrix}=\begin{bmatrix}0\\f(t)\end{bmatrix}\] <p>And indeed! This is the system of equations one gets when deriving variation of parameters. This is a good sign…</p> <p>The columns of \(\Psi(t)\) are linearly independent so it is invertible</p> \[\begin{equation} u'(t)=\Psi^{-1}(t)g(t) \end{equation}\] \[\begin{bmatrix}u_1'(t)\\u_2'(t)\end{bmatrix}=\begin{bmatrix}y_1(t)&amp;y_2(t)\\y_1'(t)&amp;y_2'(t)\end{bmatrix}^{-1}\begin{bmatrix}0\\f(t)\end{bmatrix}\] <p>Using the simple formula for the inverse of a \(2\times 2\) matrix,</p> \[\begin{bmatrix}u_1'(t)\\u_2'(t)\end{bmatrix}=\frac{1}{y_1(t)y_2'(t)-y_2(t)y_1'(t)}\begin{bmatrix}y_2'(t)&amp;-y_2(t)\\-y_1'(t)&amp;y_1(t)\end{bmatrix}\begin{bmatrix}0\\f(t)\end{bmatrix}\] <p>Hopefully, you recognize that determinant \(\det(\Psi(t))\) as the Wronskian, \(W [ y_1(t),y_2(t) ] (t)=y_1(t)y_2'(t)-y_2(t)y_1'(t)\), which we will just denote as \(W(t)\).</p> \[\begin{equation} \begin{bmatrix}u_1'(t)\\u_2'(t)\end{bmatrix}=\begin{bmatrix}-y_2(t)\\y_1(t)\end{bmatrix}\frac{f(t)}{W(t)} \end{equation}\] <p>If you are familiar with the formula for variation of parameters with second-order linear differential equations, hopefully, the pieces of the puzzle seem to be falling into place.</p> <p>Next, we integrate to get \(u_1\) and \(u_2\).</p> \[\begin{equation} \begin{bmatrix}u_1(t)\\u_2(t)\end{bmatrix}= \begin{bmatrix} \int_{t_0}^t-y_2(s)\frac{f(s)}{W(s)}\,ds\\ \int_{t_0}^ty_1(s)\frac{f(s)}{W(s)}\,ds \end{bmatrix} +\begin{bmatrix}c_1\\c_2\end{bmatrix} \end{equation}\] <p>These don’t <em>have</em> to be definite integrals in \(s\), and indefinite integrals would be totally fine. However, the benefit of doing it this way is that our particular solution will satisfy rest conditions, \(y(t_0)=y'(t_0)=0\). It doesn’t really matter that much, though.</p> \[\begin{align} u_1(t)=-&amp;\int_{t_0}^t\frac{y_2(s)}{W(s)}f(s)\,ds+c_1\\ u_2(t)=&amp;\int_{t_0}^t\frac{y_1(s)}{W(s)}f(s)\,ds+c_2 \end{align}\] <p>Therefore we have derived the formula for variation of parameters!</p> \[\begin{equation} y_p(t)=-y_1(t)\int_{t_0}^t\frac{y_2(s)}{W(s)}f(s)\,ds+y_2(t)\int_{t_0}^t\frac{y_1(s)}{W(s)}f(s)\,ds \end{equation}\] <p>By doing a definite integral in \(s\), we can also condense the two integrals into one. The general solution can then be written as</p> \[\begin{equation} y(t)=\int_{t_0}^t\frac{y_1(s)y_2(t)-y_2(s)y_1(t)}{y_1(s)y_2'(s)-y_2(s)y_1'(s)}f(s)\,ds+c_1y_1(t)+c_2y_2(t) \end{equation}\] <p>This process can absolutely be repeated for higher order equations. The tricky part is calculating \(\Psi^{-1}\). The good news is that you only need the rightmost column. The entries of those columns will then be the cofactors obtained by covering up the bottom row and one of the other columns. In general, for an \(n\)-th order differential equation, if we denote the cofactor of the entry in the \(i\)-th row and \(j\)-th column of \(\Psi\) as \((\Psi)_{ij}\), then</p> \[\begin{equation} u_i'=\frac{(\Psi)_{ni}}{\det(\Psi(t))}f(t) \end{equation}\] <p>So basically cover up the bottom row and \(i\)-th column of \(\Psi\) and take the determinant.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 14, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>