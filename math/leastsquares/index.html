<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Introduction to Least Squares | smashmath</title> <meta name="author" content=" "> <meta name="description" content="How to find the best solution for an inconsistent system"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/math/leastsquares/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Introduction to Least Squares</h1> <p class="post-description">How to find the best solution for an inconsistent system</p> </header> <article> <p>Suppose we have two vectors \(\vec{v},\vec{b}\in\mathbb{R}^n\)</p> <p>The system</p> <p>\begin{equation} \label{1} \vec{v}x=\vec{b} \end{equation}</p> <p>in all likelihood has no solution unless \(\vec{b}\) happens to be a scalar multiple of \(\vec{v}\). So, let us attempt to find the value of \(x\) which gives the best approximation.</p> <p>To measure how accurate our solution is in terms of \(x\), we can simply deal with the magnitude of the difference between \(\vec{v}x\) and \(\vec{b}\). We use the magnitude squared as it makes calculations easier and has no effect on the solution.</p> <p>\begin{equation} \label{2} \delta(x)= | \vec{v}x-\vec{b} | ^2 \end{equation}</p> <p>We can take advantage of the fact that for real vectors, \(| \vec{v}| ^2=\vec{v}^T\vec{v}\). Note also that for real vectors \(\vec{v}^T\vec{b}=\vec{v}\cdot \vec{b}\).</p> <p>\begin{gather} \label{3} |\vec{v}x-\vec{b}|^2=(\vec{v}x-\vec{b})^T(\vec{v}x-\vec{b})<br> \delta(x)=\vec{v}^T\vec{v}x^2-(\vec{v}^T\vec{b}+\vec{b}^T\vec{v})x+\vec{b}^T\vec{b} \end{gather}</p> <p>Being \(1\times1\) matrices, \(\vec{b}^T\vec{v}=\vec{v}^T\vec{b}\)</p> <p>\begin{equation} \label{4} \delta(x)=\vec{v}^T\vec{v}x^2-2(\vec{v}^T\vec{b})x+\vec{b}^T\vec{b} \end{equation}</p> <p>Solve for \(\delta'(x)=0\)</p> <p>\begin{equation} \label{5} \delta’(x)=2\vec{v}^T\vec{v}x-2(\vec{v}^T\vec{b})=0 \end{equation}</p> <p>\begin{equation} \label{6} x=\frac{\vec{v}^T\vec{b}}{\vec{v}^T\vec{v}}=\frac{\vec{v}\cdot \vec{b}}{|\vec{v}|^2} \end{equation}</p> <p>Look at that! It’s the coefficient for the projection of a vector \(\vec{b}\) onto \(\vec{v}\). Looks like we were on the right track all along!</p> <p>If we go back a step and multiply both sidesof \eqref{6} by \(\vec{v}^T\vec{v}\), we get</p> <p>\begin{equation} \label{7} (\vec{v}^T\vec{v})x=\vec{v}^T\vec{b} \end{equation}</p> <p>Which is exactly the equation we started with \eqref{1} just with both sides multiplied by \(\vec{v}^T\). And indeed, the best approximate solution (also called the least squares solution) of an inconsistent system</p> \[A\vec{x}=\vec{b}\] <p>is found by instead solving the “normal equation of \(A\vec{x}=\vec{b}\)”</p> <p>\begin{equation} \label{8} A^TA\vec{x}=A^T\vec{b} \end{equation}</p> <p>One thing to note: \(A^TA\) will be invertible if and only if the columns of \(A\) are linearly independent.</p> <h2 id="an-application">An Application</h2> <p>One of the big applications is linear interpolation, or finding a line of best fit. Let’s say we have a list of points \(\{(x_1,y_1),\ldots,(x_n,y_n)\}\). If we had a line \(y=c_0+c_1x\) that theoretically passed through all \(n\) of these points, then that means</p> \[\begin{gather*} c_0+c_1x_1=y_1\\ \vdots\\ c_0+c_1x_n=y_n \end{gather*}\] <p>Of course, we can express this as s system of equations:</p> \[\begin{equation} \begin{bmatrix}1&amp;x_1\\\vdots&amp;\vdots\\1&amp;x_n\end{bmatrix}\begin{bmatrix}c_0\\c_1\end{bmatrix}=\begin{bmatrix}y_1\\\vdots\\y_n\end{bmatrix} \end{equation}\] <p>Let’s not be naive. This system probably has no solution. In which case, we can multiply by the transpose of the coefficient matrix to get the normal equation. Do observe that the columns will be linearly independent unless \(x_1=x_2=\ldots=x_n\) (which would be dumb).</p> \[\begin{equation} \begin{bmatrix}1&amp;\dots&amp;1\\x_1&amp;\dots&amp;x_n\end{bmatrix} \begin{bmatrix}1&amp;x_1\\\vdots&amp;\vdots\\1&amp;x_n\end{bmatrix}\begin{bmatrix}c_0\\c_1\end{bmatrix}= \begin{bmatrix}1&amp;\dots&amp;1\\x_1&amp;\dots&amp;x_n\end{bmatrix} \begin{bmatrix}y_1\\\vdots\\y_n\end{bmatrix} \end{equation}\] <p>If we denote the vectors \(\vec{1}=(1,\ldots,1)\in\mathbb{R}^n\), \(\vec{x}=(x_1,\ldots,x_n)\), and \(\vec{y}=(y_1,\ldots,y_n)\), the system becomes</p> \[\begin{equation} \begin{bmatrix}n&amp;\vec{1}\cdot\vec{x}\\\vec{1}\cdot\vec{x}&amp;|\vec{x}|^2\end{bmatrix} \begin{bmatrix}c_0\\c_1\end{bmatrix}= \begin{bmatrix}\vec{1}\cdot\vec{y}\\\vec{x}\cdot\vec{y}\end{bmatrix} \end{equation}\] <p>If you think I’m going to row reduce this, you are out of your mind. Cramer’s Rule is bae once again <img class="emoji" title=":sunglasses:" alt=":sunglasses:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f60e.png" height="20" width="20"></p> \[\begin{equation} c_0=\frac{\begin{vmatrix}\vec{1}\cdot\vec{y}&amp;\vec{1}\cdot\vec{x}\\\vec{x}\cdot\vec{y}&amp;|\vec{x}|^2\end{vmatrix}}{\begin{vmatrix}n&amp;\vec{1}\cdot\vec{x}\\\vec{1}\cdot\vec{x}&amp;|\vec{x}|^2\end{vmatrix}},\; c_1=\frac{\begin{vmatrix}n&amp;\vec{1}\cdot\vec{y}\\\vec{1}\cdot\vec{x}&amp;\vec{x}\cdot\vec{y}\end{vmatrix}}{\begin{vmatrix}n&amp;\vec{1}\cdot\vec{x}\\\vec{1}\cdot\vec{x}&amp;|\vec{x}|^2\end{vmatrix}} \end{equation}\] <p>And you could always use my <a href="../functioninterp/" target="_blank">determinant polynomial</a> to get the equation for the line of best fit as</p> \[\begin{equation} y=\frac{\begin{vmatrix}1&amp;x&amp;0\\n&amp;\vec{1}\cdot\vec{x}&amp;\vec{1}\cdot\vec{y}\\\vec{1}\cdot\vec{x}&amp;|\vec{x}|^2&amp;\vec{x}\cdot\vec{y}\end{vmatrix}} {n(x_1^2+\ldots+x_n^2)-(x_1+\ldots+x_n)^2} \end{equation}\] </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: September 26, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>