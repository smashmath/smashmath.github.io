<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Solving Multiple Initial Value Problems with Normalized Solutions | smashmath</title> <meta name="author" content=" "> <meta name="description" content="Solve one, solve them all."> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/math/normalized/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Solving Multiple Initial Value Problems with Normalized Solutions</h1> <p class="post-description">Solve one, solve them all.</p> </header> <article> <h1 id="when-would-this-technique-be-useful">When would this technique be useful?</h1> <p>If you know you will be working with one specific differential equation with many different initial conditions, this technique will remove the need to solve more than the homogeneous solution, and merely requires finding a matrix inverse.</p> <h1 id="normalized-solutions">Normalized Solutions</h1> <p>Less important is the equation than the solution.</p> \[\begin{gather} \label{ivp} L[y]=0,\quad y(t_0)=y_0,\ldots,y^{(n-1)}(t_0)=y^{(n-1)}_0\\ y=c_1y_1+\ldots+c_ny_n \end{gather}\] <p>In the case that the differential equation is nonhomogeneous, one may use the convolution or any other technique to get a \(y_p\) such that \(y_p(t_0)=y_p'(t_0)=\ldots=y_p^{(n-1)}(t_0)=0\) and simply add it at the end.</p> <p>To use the technique, we construct the matrix</p> \[\begin{equation} W(t)= \begin{bmatrix} y_1(t)&amp;\dots&amp;y_n(t)\\ \vdots&amp;\ddots&amp;\vdots\\ y_1^{(n-1)}(t)&amp;\dots&amp;y_n^{(n-1)}(t) \end{bmatrix} \end{equation}\] <p>And define the following vectors:</p> \[\begin{gather} \vec{y}(t)= \begin{bmatrix} y_1(t)\\\vdots\\y_n(t) \end{bmatrix}\\ \vec{y}_0= \begin{bmatrix} y_0\\\vdots\\y^{(n-1)}_0 \end{bmatrix} \end{gather}\] <p>The solution to any initial value problem is then</p> \[\begin{equation} y=\vec{y}(t)^TW(t_0)^{-1}\vec{y}_0 \end{equation}\] <p>More specifically, each entry \(Y_i\) of \(\vec{y}(t)^TW(t_0)^{-1}\) will be a solution to the initial value problem,</p> \[\begin{gather*} L[y]=0\\ y(y_0)=\ldots=y^{(i-2)}(t_0)=y^{(i)}(t_0)=\ldots=y^{(n-1)}(t_0)=0\\ y^{(i-1)}(t_0)=1 \end{gather*}\] <p>More simply, each normalized solution is obtained by considering each column of \(W(t_0)^{-1}\) to be its coordinate vector in therms of the basis \(\{y_1,\ldots,y_n\}\).</p> <p>Therefore, the solution to \eqref{ivp} will be</p> \[\begin{equation} y=y_0Y_1+y'_0Y_2+\ldots+y^{(n-1)}_0Y_n \end{equation}\] <p>This makes solving any initial value problem trivial. We just change the coefficients to the initial conditions and we’re done.</p> <p>This, of course, would be a waste of time if we only had to solve one equation. But given an extensive list of initial value problems with the same differential equation, this is well worth the effort so that we don’t have to solve a system of equations <em>every time</em>.</p> <h2 id="a-big-brain-remark-on-autonomous-equations">A Big-Brain Remark On Autonomous Equations:</h2> <p>Note that for an autonomous equation, (i.e. constant coefficients), if \(t_0\neq 0\), then we can still use</p> \[\begin{equation} y=\vec{y}(t-t_0)^TW(0)^{-1}\vec{y}_0 \end{equation}\] <p>which is of great help because \(W(t_0)\) for \(t\neq0\) is usually an algebraic nightmare, while \(W(0)\) is quite nice most of the time.</p> <h2 id="without-linear-algebra">Without Linear Algebra</h2> <p>If finding the inverse of a matrix intimidates you, then instead suppose</p> \[\begin{equation} Y_i=k_1y_1+\ldots+k_ny_1 \end{equation}\] <p>and solve \(n\) systems of equations of the form</p> \[\begin{gather*} k_1y_1(t_0)+\ldots+k_ny_n(t_0)=0\\ \vdots\\ k_1y_1^{(i-1)}(t_0)+\ldots+k_ny_n^{(i-1)}(t_0)=1\\ \vdots\\ k_1y_1^{(n-1)}(t_0)+\ldots+k_ny_n^{(n-1)}(t_0)=0\\ \end{gather*}\] <p>for \(1\leq i\leq n\). If \(n&gt;3\) however, it would be faster to learn how to invert a matrix than it would be to solve all those systems.</p> <h2 id="an-example">An Example</h2> <p>Suppose we need to solve the two initial value problems,</p> \[\begin{align} y'''+2y''+y'+2y&amp;=0,&amp;y(1)&amp;=\ln(2),&amp;y'(1)&amp;=e^{-420\pi},&amp;y''(1)&amp;=\cos(69)\\ y'''+2y''+y'+2y&amp;=0,&amp;y(\sqrt{\pi} )&amp;=5^{\ln(3)},&amp;y'(\sqrt{\pi} )&amp;=\sqrt{666},&amp;y''(\sqrt{\pi} )&amp;=(27)^{4/5}\\ \end{align}\] <p>No thank you, am I right? Well, if we find normalized solutions it won’t be that bad.</p> <p>First we solve the homogeneous equation to get the solution</p> \[\begin{equation} y=c_1e^{-2t}+c_2\cos(t)+c_3\sin(t) \end{equation}\] <p>\(W(0)\) is then</p> \[\begin{equation} W(0)= \begin{bmatrix} 1&amp;1&amp;0\\ -2&amp;0&amp;1\\ 4&amp;-1&amp;0\\ \end{bmatrix} \end{equation}\] <p>Next we invert the matrix,</p> \[\begin{equation} W(0)^{-1}= \frac{1}{5} \begin{bmatrix} 1&amp;0&amp;1\\ 4&amp;0&amp;-1\\ 2&amp;5&amp;2 \end{bmatrix} \end{equation}\] <p>And… that’s enough to solve both problems. We compute \(\vec{y}(t-t_0)^TW(0)^{-1}\) (i.e. get the coordinates from the columns):</p> \[\begin{align*} Y_1&amp;=\frac{1}{5}[e^{-2(t-t_0)}+4\cos(t-t_0)+2\sin(t-t_0)]\\ Y_2&amp;=\sin(t-t_0)\\ Y_3&amp;=\frac{1}{5}[e^{-2(t-t_0)}-\cos(t-t_0)+2\sin(t-t_0)]\\ \end{align*}\] <p>And the two solutions are as follows:</p> \[\begin{align*} y=&amp; \frac{\ln(2)}{5}[e^{-2(t-1)}+4\cos(t-1)+2\sin(t-1)]\\ &amp;+e^{-420\pi}\sin(t-1)\\ &amp;+\frac{\cos(69)}{5}[e^{-2(t-1)}-\cos(t-1)+2\sin(t-1)] \end{align*}\] <p>and</p> \[\begin{align*} y=&amp; \frac{5^{\ln(3)}}{5}[e^{-2(t-\sqrt{\pi} )}+4\cos(t-\sqrt{\pi} )+2\sin(t-\sqrt{\pi} )]\\ &amp;+\sqrt{666}\sin(t-\sqrt{\pi} )\\ &amp;+\frac{(27)^{4/5}}{5}[e^{-2(t-\sqrt{\pi} )}-\cos(t-\sqrt{\pi} )+2\sin(t-\sqrt{\pi} )] \end{align*}\] <h2 id="proof">Proof</h2> <p>Consider the function</p> \[\begin{equation} y(t)=\vec{y}(t)^TW(t_0)^{-1}\vec{y}_0 \end{equation}\] <p>where</p> \[\begin{gather} \vec{y}(t)= \begin{bmatrix} y_1(t)\\\vdots\\y_n(t) \end{bmatrix}\\ \vec{y}_0= \begin{bmatrix} y_0\\\vdots\\y^{(n-1)}_0 \end{bmatrix}\\ W(t)= \begin{bmatrix} y_1(t)&amp;\dots&amp;y_n(t)\\ \vdots&amp;\ddots&amp;\vdots\\ y_1^{(n-1)}(t)&amp;\dots&amp;y_n^{(n-1)}(t) \end{bmatrix} \end{gather}\] <p>Notice that</p> \[\begin{equation} \vec{y}(t)=W(t)^T\vec{e}_1\implies \vec{y}(t)^T=\vec{e}^T_1W(t) \end{equation}\] <p>where \(\vec{e}_i\) is the \(i\)-th standard basis vector.</p> <p>By linearity,</p> \[\begin{equation} \vec{y}^{(i)}(t)= \begin{bmatrix} y_1^{(i)}(t)\\\vdots\\y_n^{(i)}(t) \end{bmatrix} \end{equation}\] <p>which implies</p> \[\begin{equation} \vec{y}^{(i)}(t)=W(t)^T\vec{e}_{i+1}\implies \vec{y}^{(i)}(t)^T=\vec{e}^T_{i+1}W(t) \end{equation}\] <p>Additionally, since \(W(t_0)\) and \(\vec{y}_0\) are constant,</p> \[\begin{equation} y^{(i)}(t)=\vec{y}^{(i)}(t)^TW(t_0)^{-1}\vec{y}_0 \end{equation}\] <p>Consider \(y^{(i)}(t_0)\),</p> \[\begin{equation} y^{(i)}(t_0)=\vec{y}^{(i)}(t_0)^TW(t_0)^{-1}\vec{y}_0 \end{equation}\] \[\begin{equation} y^{(i)}(t_0)=\vec{e}^T_{i+1}W(t_0)W(t_0)^{-1}\vec{y}_0 \end{equation}\] \[\begin{equation} y^{(i)}(t_0)=\vec{e}^T_{i+1}\vec{y}_0 \end{equation}\] \[\begin{equation} y^{(i)}(t_0)=y_0^{(i)} \end{equation}\] <p>Therefore, the function \(y(t)\) satisfies the conditions</p> \[y(t_0)=y_0,\ldots,y^{(n-1)}(t_0)=y^{(n-1)}_0\quad \blacksquare\] </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: May 14, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>