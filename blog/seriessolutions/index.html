<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Series Solutions Done Quick | smashmath</title> <meta name="author" content=" "> <meta name="description" content="the fast way to do series solutions. no reindexing required."> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/seriessolutions/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Series Solutions Done Quick",
      "description": "the fast way to do series solutions. no reindexing required.",
      "published": "June 6, 2022",
      "authors": [
        {
          "author": "Taylor F.",
          "authorURL": "",
          "affiliations": [
            {
              "name": "None",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Series Solutions Done Quick</h1> <p>the fast way to do series solutions. no reindexing required.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#important-series">Important Series</a></div> <div><a href="#euler-equations-intro">Euler Equations (Intro)</a></div> <div><a href="#example-legendre-equation">Example (Legendre equation)</a></div> <div><a href="#the-straggler-coefficients">The Straggler Coefficients</a></div> <ul> <li><a href="#the-direct-way-to-calculate-coefficients">The direct way to calculate coefficients</a></li> </ul> <div><a href="#when-the-ivp-is-not-centered-at-0">When the IVP is not centered at 0</a></div> <div><a href="#more-examples">More Examples</a></div> </nav> </d-contents> <h1 id="important-series">Important Series</h1> \[\begin{align} y&amp;=\sum_{n=0}^\infty a_nx^n\\ y'&amp;=\sum_{n=0}^\infty (n+1)a_{n+1}x^{n}&amp;=&amp;\sum_{n=0}^\infty na_{n}x^{n-1}\\ y''&amp;=\sum_{n=0}^\infty (n+1)(n+2)a_{n+2}x^{n}&amp;=&amp;\sum_{n=0}^\infty n(n-1)a_{n}x^{n-2}\\ \end{align}\] <p>Note: For the series with \(x^{n-1}\) or \(x^{n-2}\), you may have to have the starting index be \(n=1\) or \(n=2\) respectively. However, we can technically start at zero generally, because when \(n=0\), we get that \(na_{n}x^{n-1}=0\) too. Try not to worry too much about it, as it really speeds things along when you start them all on \(n=0\).</p> <hr> <p>Here I will present the fast way to do series solutions. Essentially, we rearrange the differential equation such that reindexing is unnecessary. To explain how that works, let’s start by looking at Euler Equations.</p> <h1 id="euler-equations-intro">Euler Equations (Intro)</h1> <p>An Euler equation is of the form</p> \[\begin{equation} p_2x^2y''+p_1xy'+p_0y=0 \end{equation}\] <p>Where \(p_0,p_1,p_2\) are constants.</p> <p>The solutions to these equations are generally of polynomial form (similar to how solutions to constant coefficient linear ODEs are of exponential form), as we multiply by the independent variable with every differentiation, canceling the decreasing power which occurs when differentiating polynomials. We can use this fact to skip reindexing the series!</p> <p>Suppose we plug in our series solution to this differential equation. Because we have \(xy'\), we want to use \(y'=\sum_{n=0}^\infty na_{n}x^{n-1}\), and because we have \(x^2y''\), we want to use \(y''=\sum_{n=0}^\infty n(n-1)a_{n}x^{n-2}\), since that will give us \(x^n\) on all the terms. Notice how all three terms will also have \(a_n\)! Thus, when we combine it all, we get</p> \[\begin{equation} \sum_{n=0}^\infty(p_2n(n-1)+p_1n+p_0)a_nx^n=0 \end{equation}\] <p>Notice how the term multiplying \(a_nx^n\) is <em>almost</em> the characteristic polynomial if it was constant coefficients. This is actually called the “indicial equation”, which is slightly different. For the \(p_mt^my^{(m)}\) term in the ODE, the corresponding term in the indicial equation is \(p_mn(n-1)\ldots(n-m+1)=p_m\frac{n!}{(n-m)!}\).</p> <p>So, what happens when it isn’t exactly an Euler equation? Then you just group them up by shifted powers. For example,</p> \[(x^2+x+1)y''+(x^2+1)y'+(x^2+x+1)y=0\] <p>can be grouped up as follows:</p> \[(x^2y''+y'+y)+(xy''+y')+(y'')+(x^2y)+(xy)\] <p>Basically, you want groups of descending powers and orders. We’ll call these “EE groups”, for Euler Equation groups.</p> \[(x^2y''+y'+y)+\frac{1}{x}(x^2y''+xy')+\frac{1}{x^2}(x^2y'')+x^2(y)+x(y)\] <p>Then you will have to shift the index by some amount. To see this, compare \(y''\mapsto(n+1)(n+2)a_{n+2}\) and \(x^2y''\mapsto n(n-1)a_n\). The first is just the second, but \(n\) has been shifted <strong>up</strong> by 2.</p> <p>So if you have a positive power of \(x\) multiplying an Euler Equation, you shift the index of the EE group down by that power.</p> <p>If you have a positive power of \(x\) dividing an Euler Equation, you shift the index of the EE group up by that power.</p> <p>Let’s look at an example.</p> <h1 id="example-legendre-equation">Example (Legendre equation)</h1> \[(1-x^2)y''-2xy'+\alpha(\alpha+1)y=0\] <p>Notice how this is <em>almost</em> an Euler equation. We have an \(x^2y''\) and an \(xy'\) term, but there’s a \(y''\) all by itself bringing down the party. So let’s rearrange the equation as such:</p> \[y''-(x^2y''+2xy'-\alpha(\alpha+1)y)=0\] <p>And, well, we actually know the series expansion for both terms. We know that \(y''=\sum_{n=0}^\infty (n+1)(n+2)a_{n+2}x^{n}\) and</p> \[x^2y''+2xy'-\alpha(\alpha+1)y=\sum_{n=0}^\infty(n(n-1)+2n-\alpha(\alpha+1))a_nx^n\] <p>We can factor \(n(n-1)+2n-\alpha(\alpha+1)=(n-\alpha)(n+\alpha+1)\).</p> <p>So, plugging in our series will yield us</p> \[\sum_{n=0}^\infty \bigg( (n+1)(n+2)a_{n+2}-(n-\alpha)(n+\alpha+1)a_n \bigg)x^n=0\] <p>Observe that there was no point to even writing the sum. We could have jumped straight to</p> \[(n+1)(n+2)a_{n+2}-(n-\alpha)(n+\alpha+1)a_n=0\implies a_{n+2}=\frac{(n-\alpha)(n+\alpha+1)a_n}{(n+1)(n+2)}\] <p>And there’s our recurrence relation! That was quick. Now we can start plugging in \(n=0,1,2,\ldots\) to find our power series coefficients. Such as,</p> \[a_2=-\frac{\alpha(\alpha+1)}{2}a_0\] \[a_3=-\frac{(\alpha-1)(\alpha+2)}{3!}a_0\] <h1 id="the-straggler-coefficients">The Straggler Coefficients</h1> <p>When doing series solutions the normal way, often you get stragglers that end up outside of the sum. Rather than worry about them at all, we can skip that entirely by calculating the relationship between the first few coefficients directly from the original ODE itself.</p> <h2 id="the-direct-way-to-calculate-coefficients">The direct way to calculate coefficients</h2> <p>Once you see it, you may think “wait, we can just do that?” And the answer will be a resounding “YES”. Also, <strong>this is almost always the fastest way to do problems which ask you to find the first few terms of the series solution to an initial value problem, but not a closed form</strong>!</p> <p>Basically, for the initial value problem,</p> \[\begin{equation} y''=p(x)y'+q(x)y,\quad y(0)=y_0,\;y'(0)=y'_0 \end{equation}\] <p>First, we know that \(a_0=y_0\) and \(a_1=y'_0\). That directly follows from Taylor’s theorem.</p> <p>Now, check out what happens if we just plug in \(x=0\) to the equation. Note that if \(y=a_0+a_1x+a_2x^2+\ldots\), then using Taylor’s theorem we know that \(a_n=\frac{y^{(n)}(0)}{n!}\). Which implies that \(y^{(n)}(0)=n!\,a_n\).</p> \[y''(0)=p(0)y'(0)+q(0)y(0)\implies 2!\,a_2=p(0)y'_0+q(0)y_0\] <p>Thus, we can solve for \(a_2\) directly:</p> \[a_2=\frac{1}{2}(p(0)y'_0+q(0)y_0)\] <p>There is really no need to memorize this formula, but just remember that you can use this method to directly calculate the coefficients which are left out of the series (or cannot be directly computed from the recurrence relation).</p> <p>But wait, there’s more! You can find more than just \(a_2\), if you differentiate the whole ODE.</p> \[y'''=p(x)y''+(p'(x)+q(x))y'+q'(x)y\] <p>Then you can just plug in \(x=0\) again!</p> <p><strong>Important note</strong>: If there is a coefficient on the \(y''\) term, then it is often advantageous NOT to divide it out. This usually simplifies the differentiation greatly, since you’re doing the product rule and not the quotient rule. And there are tricks for multiple applications of the product rule (like using Pascal’s triangle), but nothing like that for the quotient rule.</p> <h1 id="when-the-ivp-is-not-centered-at-0">When the IVP is not centered at 0</h1> <p>This is actually really great. You can do a quick change of variables and then carry on as if \(x_0=0\). Just do \(t=x-x_0\implies x=t+x_0\). So,</p> \[P(x)y''+Q(x)y'+R(x)y=0,\quad y(x_0)=y_0,\;y'(x_0)=y'_0\] <p>becomes</p> \[P(t+x_0)y''+Q(t+x_0)y'+R(t+x_0)y=0,\quad y(0)=y_0,\;y'(0)=y'_0\] <p>And then you just do as you do normally. No need to write \(y=\sum_{n=0}^\infty a_n(x-x_0)^n\), or to find the Taylor series of \(P,Q,R\) centered around \(x_0\). Do you <em>want</em> to do that? Because I don’t.</p> <p>Instead, just do the normal solution method with \(y=\sum_{n=0}^\infty a_nt^n\).</p> <h1 id="more-examples">More Examples</h1> <p>Find closed forms for the general solution of</p> \[(x^2-4x-1)y''-2(x-2)y'+2y=0\] <p>We rearrange it into EE groups:</p> \[(x^2y''-2xy'+2y)-4(xy''-y')-y''=0\] <p>The first term will be \(x^2y''-2xy'+2y\mapsto (n(n-1)-2n+2)a_n=(n-1)(n-2)a_n\).</p> <p>The second term will be \(4(n(n-1)-n)a_n=4n(n-2)a_n\) but shifted up by one, since it’s a power below an Euler Equation. Thus, \(4(xy''-y')\mapsto 4(n+1)(n-1)a_{n+1}\).</p> <p>And finally, we are very familiar with \(y''\mapsto(n+1)(n+2)a_{n+2}\).</p> <p>In total, giving us</p> \[(n-1)(n-2)a_n-4(n+1)(n-1)a_{n+1}-(n+1)(n+2)a_{n+2}=0\] <p>Solving for the highest index term,</p> \[a_{n+2}=(n-1)\frac{(n-2)a_n-4(n+1)a_{n+1}}{(n+1)(n+2)}\] <p>The most interesting thing to observe is the \((n-1)\) multiplying the whole thing. This means that plugging in \(n=1\) gives us</p> \[a_3=0\] <p>And if we plug in anything higher than \(n=1\), such as \(n=2\), we get</p> \[a_4=1\frac{0a_2-8a_3}{12}=0\] <p>So it seems our solutions don’t have Taylor series which go higher than a quadratic. Plugging in \(n=0\) yields</p> \[a_2=a_0+2a_1\] <p>So we can say that our solution is</p> \[y=a_0+a_1x+(a_0+2a_1)x^2=a_0(1+x^2)+a_1(x+2x^2)\] <p>We can let \(a_0\) and \(a_1\) be our arbitrary constants, and it gives us the <a href="../normalized/" target="_blank">normalized solutions</a>!</p> \[y=c_1(1+x^2)+c_2(x+2x^2)\] <p>Setting \(c_1=-2,\;c_2=1\) gives us that \(y=x-2\) is a solution. As a pro-tip, you could have actually seen that solution by inspection!</p> <p>In general, if you have a linear function on \(y'\) and the slope constant on \(y\),</p> \[P(x)y''+(mx+b)y'-my=0\] <p>then \(y=mx+b\) will be a solution. This is especially useful if you have something like</p> \[P(x)y''-xy'+y=0\] <p>Then \(y=x\) is a solution to this, for example.</p> <hr> <p>Find the solution to</p> \[y''+(t-1)y'+2y=0,\quad y(1)=0,\;y'(1)=1\] <p>We can start by simplifying the problem with a change of variables which will center the initial value problem around zero: \(x=t-1\). Plugging that in gives us</p> \[y''+xy'+2y=0,\quad y(0)=0,\;y'(0)=1\] <p>We can rearrange it into two EE groups</p> \[y''+(xy'+2y)=0\] <p>\(xy'+2y\) is fairly straightforward as \((n+2)a_n\). And, once again, \(y''\mapsto(n+1)(n+2)a_{n+2}\). So our recurrence relation is</p> \[((n+1)(n+2)a_{n+2})+((n+2)a_n)=0\] <p>Since \(n\geq0\implies n+2\neq0\), we can divide out the \(n+2\) from the equation to get</p> \[a_{n+2}=-\frac{a_n}{n+1}\] <p>Now, we can find our coefficients.</p> \[a_2=-a_0=0\] <p>We can see that every even \(n\) will result in zero. So we can just focus on the odd terms. In cases where every other coefficient is zero, it is sometimes the case that the solution (or part of it) is a function of \(x^2\). Let’s keep that in mind.</p> \[a_3=-\frac{a_1}{2}=-\frac{1}{2}\] \[a_5=\frac{1}{2\cdot 4}=\frac{1}{2^2(2!)}\] <p>Often, it can make it easier to see the pattern when you force a factorial in there.</p> \[a_7=-\frac{1}{2^2(2!)\cdot 6}=-\frac{1}{2^3(3!)}\] <p>And we can see that this pattern will repeat. So it appears that</p> \[a_{2n+1}=\frac{\left(-\frac{1}{2}\right)^n}{n!}\] <p>Making our solution \(y=\sum_{n=0}^\infty \frac{\left(-\frac{1}{2}\right)^nx^{2n+1}}{n!}\), which we can manipulate into</p> \[y=x\sum_{n=0}^\infty \frac{\left(-\frac{x^2}{2}\right)^n}{n!}=xe^{-\frac{x^2}{2}}\] <p>Finally, we undo the substitution to get our actual solution</p> \[y=(t-1)e^{-\frac{(t-1)^2}{2}}\] <hr> <p>Note, we could have sorta cheesed it by using the direct method. By solving for \(y''\), we get</p> \[y''=-(t-1)y'-2y\] <p>Then, plugging in \(t=1\) and then differentiating, we get the following:</p> \[2a_2=0a_1-2(0)=0\] \[y'''=-(t-1)y''-3y'\] \[3!a_3=-3a_1\implies a_3=-\frac{1}{2}\] \[y^{(4)}=-(t-1)y'''-4y''\] <p>We can observe once again, that the even terms produce zero.</p> \[y^{(5)}=-(t-1)y^{(4)}-5y'''\] \[5!a_5=-5(3!)a_3\implies a_5=\frac{1}{8}\] <p>And so on…</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: January 16, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>