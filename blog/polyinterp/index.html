<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Polynomial Interpolation | smashmath</title> <meta name="author" content=" "> <meta name="description" content="Making your own custom polynomial."> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/polyinterp/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Polynomial Interpolation</h1> <p class="post-description">Making your own custom polynomial.</p> </header> <article> <p>This post is separated into sections based on difficulty. While hopefully anyone with some algebra experience can follow along with the first few sections, the later sections use topics from more advanced math courses like Calculus and Linear Algebra.</p> <hr> <p>When I was just starting to learn algebra, and we were learning about quadratics, I wanted to know how to find a quadratic that passed through certain points. I’ve never been an artist, but the idea of “drawing” a polynomial was novel to me. It wasn’t until college that someone told me how I could do it.</p> <p>And while I’m perfectly content making up polynomials that look nice just for fun, polynomial interpolation has a number of useful applications. Some of these are:</p> <ol> <li>Approximating definite integrals of difficult functions by instead integrating an interpolating polynomial</li> <li>Filling in values between data points. This can be used to approximate the values of functions like \(\ln(x)\) or the trig functions</li> <li>Approximating complicated curves if you only have a few points</li> </ol> <p>And while this is a topic that is <em>occasionally</em> touched on in a linear algebra course, it really only requires relatively basic algebra to get started. If you want to get fancy and creative, then some calculus can spice it up too!</p> <hr> <p>So, let’s try to find a quadratic equation as I wanted to do a long time ago.</p> <p>I want a quadratic that passes through the points</p> <div class="caption"> $$(1,9),(2,7),(3,-1)$$ </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/poly3points.png" alt="" title=""> </div> </div> <p><br></p> <p>So we’re looking for a quadratic (degree two) polynomial. The general form of a quadratic is:</p> \[y=ax^2+bx+c\] <p>However, I’m going to start writing them in a form that generalizes more easily to higher degree polynomials using function notation.</p> <p>\begin{equation} p(x)=a_0+a_1x+a_2x^2 \end{equation}</p> <p>There is another reason I do it in this order. It will make solving this problem easier later on (if you use linear algebra).</p> <p>The first question we must ask ourselves is: “What does it <em>mean</em> for this polynomial to pass through the point \((1,9)\)?”</p> <p>That may seem like a silly question, and, indeed, when introducing this topic in linear algebra, many students are at a loss for how to even get started with this kind of problem. The key is looking at the point \((x,y)\) with this perspective:</p> <p>(the input, the output)</p> <p>And this is where function notation really helps us out. Instead of thinking about the point as \((x,y)\), we want to think about it as</p> \[(x,p(x))\] <p>In other words, if we want the polynomial to pass through a specific point, we should make sure the desired \(y\) value is produced after plugging in the related \(x\) value. So in the generic case of \((x_1,y_1)\),</p> \[a_0+a_1x_1+a_2x_1^2=y_1\] <p>which we can also compactly write as \(p(x_1)=y_1\).</p> <p>So for each point, we get one equation. In our specific example, \((1,9),(2,7),(3,-1)\), our equations are</p> \[\begin{align*} a_0+a_1(1)+a_2(1)^2&amp;=9\\ a_0+a_1(2)+a_2(2)^2&amp;=7\\ a_0+a_1(3)+a_2(3)^2&amp;=-1\\ \end{align*}\] <p>Now at this point, we have a system of three equations in three unknowns. Three <em>linear</em> equations at that. Don’t let the \(x^2\) term fool you! Our “variables” are actually the \(a\) coefficients, since it’s those we’re trying to solve for.</p> <p>Linear algebra can actually tell us that this particular system is guaranteed to have exactly one solution. We will use this idea later to tell us when we are and are not guaranteed a unique polynomial for some given conditions.</p> <p>It is at this point that I <em>highly</em> recommend writing this in matrix notation so that it’s a lot less cluttered.</p> \[\begin{equation} \begin{bmatrix} 1&amp;1&amp;1^2\\ 1&amp;2&amp;2^2\\ 1&amp;3&amp;3^2 \end{bmatrix} \begin{bmatrix} a_0\\a_1\\a_2 \end{bmatrix} =\begin{bmatrix} 9\\7\\-1 \end{bmatrix} \end{equation}\] <p>We call the big \(3\times 3\) matrix on the left the “coefficient matrix”. We can do even better, though, by writing it as an “augmented matrix”.</p> \[\begin{equation} \left[ \begin{array}{ccc|c} 1&amp;1&amp;1^2&amp;9\\ 1&amp;2&amp;2^2&amp;7\\ 1&amp;3&amp;3^2&amp;-1 \end{array} \right] \end{equation}\] <p>Much better right? Now it’s all boiled down to the parts that actually matter: the input points and the output points. We’re basically just skipping the writing of each plus and \(a\) term, and replacing the column of equal signs with a single vertical bar. It’s just a much cleaner way to write it.</p> <p>That said, if matrix notation is unfamiliar to you, feel free to ignore it! You can solve the systems you get however you like. If you are curious about how to solve systems using matrices and Gaussian elimination in linear algebra, then here is a quick explanation (that you may feel free to skip):</p> <details> <summary><b>What is Gaussian Elimination?</b> (Click to Expand)</summary> Typically, in linear algebra, one solves these systems using "Gaussian elimination" or "row reduction", which is the same "elimination" method of solving systems of equations taught in earlier algebra courses. As an example of how it works, take the system $$\begin{equation} \begin{array}{ccc} x&amp;+&amp;2y&amp;=&amp;4\\ 2x&amp;+&amp;5y&amp;=&amp;9\\ \end{array} \end{equation}$$ Using elimination we could add -2 of the first equation to the second equation to get rid of the x term. This would give us $$\begin{equation} \begin{array}{cccc} &amp;-2&amp;(&amp;x&amp;+&amp;2y&amp;)&amp;=&amp;-2(4)\\ &amp;+&amp;(&amp;2x&amp;+&amp;5y&amp;)&amp;=&amp;9\\ \hline &amp;&amp;&amp;&amp;&amp;y&amp;&amp;=&amp;1 \end{array} \end{equation}$$ Then our equations become $$\begin{equation} \begin{array}{ccc} x&amp;+&amp;2y&amp;=&amp;4\\ 0x&amp;+&amp;y&amp;=&amp;1\\ \end{array} \end{equation}$$ We can do this with our "agumented matrix" as well. The augmented matrix form of this original system of equations $$\begin{array}{ccc} x&amp;+&amp;2y&amp;=&amp;4\\ 2x&amp;+&amp;5y&amp;=&amp;9\\ \end{array}$$ would be $$\begin{equation} \left[ \begin{array}{cc|c} 1&amp;2&amp;4\\ 2&amp;5&amp;9\\ \end{array} \right] \end{equation}$$ And if we add -2 of the first row to the second (dealing with each column individually), we get $$\left[ \begin{array}{cc|c} 1&amp;2&amp;4\\ 2-2(1)&amp;5-2(2)&amp;9-2(4)\\ \end{array} \right]$$ $$\begin{equation} \left[ \begin{array}{cc|c} 1&amp;2&amp;4\\ 0&amp;1&amp;1\\ \end{array} \right] \end{equation}$$ Giving us $$\begin{array}{ccc} x&amp;+&amp;2y&amp;=&amp;4\\ 0x&amp;+&amp;y&amp;=&amp;1\\ \end{array}$$ as expected. If we add -2 of the new second equation to the first now, then we eliminate the y term in the first. This results in $$\begin{array}{ccc} x&amp;+&amp;0y&amp;=&amp;2\\ 0x&amp;+&amp;y&amp;=&amp;1\\ \end{array}$$ giving us the solution x=2, y=1. In matrix form this is $$\left[ \begin{array}{cc|c} 1&amp;0&amp;2\\ 0&amp;1&amp;1\\ \end{array} \right]$$ As you can see, although Gaussian elimination is no different in practice than regular elimination, it ends up being a lot more compact. </details> <p><br></p> <p>A brief aside: If you do choose to solve this with Gaussian elimination, notice how putting the constant term <em>first</em> will make it much easier. It’s natural to instinctively write it with the powers <em>descending</em>, since that’s the standard form of a polynomial, but that just makes it much harder to get the augmented matrix into reduced row echelon form. This way we start with a leading one in the top left corner.</p> <p>Assuming you were solving it with gaussian elimination, row reducing the matrix yields</p> \[\begin{equation} \left[ \begin{array}{ccc|c} 1&amp;0&amp;0&amp;5\\ 0&amp;1&amp;0&amp;7\\ 0&amp;0&amp;1&amp;-3 \end{array} \right] \end{equation}\] <p>The way to read this is:</p> \[\begin{array}{cccc} a_0&amp;&amp;&amp;=&amp;5\\ &amp;a_1&amp;&amp;=&amp;7\\ &amp;&amp;a_2&amp;=&amp;-3\\ \end{array}\] <p>Which should be the result you get by solving the system in whichever way you chose. <a href="https://www.desmos.com/calculator/dy3nzrkm2s" rel="external nofollow noopener" target="_blank">Here’s</a> a graph of the polynomial \(p(x)=5+7x-3x^2\). As you can see the polynomial does pass through the desired points.</p> <p>At this point, you can probably figure out most polynomial interpolation problems. Set up your system and solve. However, there are some additional subtleties and ways to make this more general that you may be interested in.</p> <hr> <h2 id="when-are-we-guaranteed-a-polynomial">When are we guaranteed a polynomial?</h2> <p>While our first example was a quadratic, let’s turn our attention to the simpler case of two points and a line to get a better intuition for this question. For the purpose of this discussion, we’re going to be assuming that no two points have the same \(x\) value.</p> <p>If you draw three random points on a piece of paper, can you draw a single straight line through all three? Almost all of the time this is impossible. Not always, however. For example, the three points</p> \[(1,1),(2,2),(3,3)\] <p>Have a line that passes through them. It’s the line \(y=x\). We call these points “collinear” because they happen to all lie on the same straight line.</p> <p>By the same logic, if we have four, five, or a hundred points, we aren’t guaranteed a line that passes through all of them unless they <em>happen</em> to be collinear.</p> <p>Well, how about two points? There is only one line in this situation. In fact we have a formula for it!</p> \[y=\frac{y_2-y_1}{x_2-x_1}(x-x_1)+y_1\] <p>This next question might seem a bit silly, but if we have just a single point, can we find a line that passes through it?</p> <p>Well… of course! Take the origin, \((0,0)\), and any line of the form</p> \[y=mx\] <p>We can pick <em>any</em> number for \(m\) that we like, and, no matter what it is, it will pass through \((0,0)\).</p> <p>So to recap:</p> <p>One point: Infinitely many lines</p> <p>Two points: Exactly one line</p> <p>Three or more points: There isn’t always a line</p> <p>So what’s the pattern here? Clearly two points is the special number for a line, but what significance is the number two?</p> <p>Earlier, I mentioned that linear algebra guaranteed that our system of three equations in three unknowns for our quadratic would have exactly one solution. Three was the magic number for a quadratic, and two seems to be the magic number for a line. Can you spot the pattern?</p> <p>The equation of a line is</p> \[p(x)=a_0+a_1x\] <p>And the key is that we have <em>two</em> unknown coefficients, \(a_0\) and \(a_1\). That gives us two degrees of freedom.</p> <p>Similarly, for a quadratic \(p(x)=a_0+a_1x+a_2x^2\), we have three coefficients, which guarantees us three points since we have three degrees of freedom.</p> <p>I call these general unknown forms such as \(p(x)=a_0+a_1x\) or \(p(x)=a_0+a_1x+a_2x^2\) the “guess”. It’s an assumption for the form of our solution. And though in real life assumptions are not always correct, in mathematics it can be en exact science to find the correct “guess” or form a solution must take. Without getting too technical, in the case of polynomials like this we are justified in just having the number of \(a_kx^k\) terms in our “guess” be equal to the number of points.</p> <p>However! Let’s suppose we didn’t realize that the polynomial that passes through \((1,1),(2,2),(3,3)\) is just a line. If we solved it by assuming the answer was of the form \(p(x)=a_0+a_1x+a_2x^2\), we would find that the \(a_2\) coefficient is just zero, giving us the “quadratic” \(p(x)=x\). So just because we have a certain number of points doesn’t mean we know exactly what degree the polynomial will be. But if we assume the number of coefficients is equal to the number of points, we are guaranteed to find exactly one solution.</p> <p>In summary: <strong>The number of points a polynomial can be guaranteed to pass through is equal to the number of unknown coefficients in our guess</strong>.</p> <p>Or in other words: <strong>There is exactly one polynomial of degree</strong> \(n-1\) <strong>or less which passes through</strong> \(n\) <strong>distinct points</strong>.</p> <p>So if you have five points, for example, that you want a polynomial to pass through, then your guess needs to be a polynomial with five unknown coefficients. Therefore, you need to assume it’s a quartic polynomial.</p> <hr> <h2 id="more-creative-constraints-calculus-required">More creative constraints (Calculus Required)</h2> <p>So far, we’ve been finding polynomials based on points that they pass through. But that’s not the only thing we can guarantee. We’re going to use a bit of calculus for this next section.</p> <p>Let’s say we want a polynomial which has a relative maximum at \((-1,2)\) and a relative minimum at \((1,-2)\). Like this.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/polyextrema.png" alt="" title=""> </div> </div> <p><br></p> <p>Calculus tells us that the slope of the tangent line is given by the derivative. So if we want our \(p(x)\) to have a relative maximum or minimum, then we need it’s derivative, \(p'(x)\), to be zero at that point.</p> <p>So not only do we have the conditions \(p(-1)=2\) and \(p(1)=-2\), but we also need \(p'(-1)=0\) and \(p'(1)=0\).</p> <p>Since we have four conditions, we need four coefficients. That means a cubic polynomial.</p> <p>\begin{equation} p(x)=a_0+a_1x+a_2x^2+a_3x^3 \end{equation}</p> <p>Taking the derivative,</p> <p>\begin{equation} p’(x)=a_1+2a_2x+3a_3x^2 \end{equation}</p> <p>And so, our conditions yield us the system of equations</p> \[\begin{array}{cccc} a_0&amp;+&amp;a_1(-1)&amp;+&amp;a_2(-1)^2&amp;+&amp;a_3(-1)^3&amp;=&amp;2\\ a_0&amp;+&amp;a_1(1)&amp;+&amp;a_2(1)^2&amp;+&amp;a_3(1)^3&amp;=&amp;-2\\ &amp;&amp;a_1&amp;+&amp;2a_2(-1)&amp;+&amp;3a_3(-1)^2&amp;=&amp;0\\ &amp;&amp;a_1&amp;+&amp;2a_2(1)&amp;+&amp;3a_3(1)^2&amp;=&amp;0\\ \end{array}\] <p>In matrix notation, this would be</p> \[\begin{equation} \left[ \begin{array}{cccc|c} 1&amp;-1&amp;(-1)^2&amp;(-1)^3&amp;2\\ 1&amp;1&amp;1^2&amp;1^3&amp;-2\\ 0&amp;1&amp;2(-1)&amp;3(-1)^2&amp;0\\ 0&amp;1&amp;2(1)&amp;3(1)^2&amp;0 \end{array} \right] \end{equation}\] <p>Now we reduce:</p> \[\begin{equation} \left[ \begin{array}{cccc|c} 1&amp;0&amp;0&amp;0&amp;0\\ 0&amp;1&amp;0&amp;0&amp;-3\\ 0&amp;0&amp;1&amp;0&amp;0\\ 0&amp;0&amp;0&amp;1&amp;1 \end{array} \right] \end{equation}\] \[\begin{array}{cccc} a_0&amp;&amp;&amp;&amp;=&amp;0\\ &amp;a_1&amp;&amp;&amp;=&amp;-3\\ &amp;&amp;a_2&amp;&amp;=&amp;0\\ &amp;&amp;&amp;a_3&amp;=&amp;1\\ \end{array}\] <p>Thus, our polynomial is \(p(x)=x^3-3x\).</p> <p>The process of solving was no different than before. The only difference was what our equations looked like. So get creative!</p> <hr> <h2 id="when-are-we-guaranteed-a-polynomial-part-2">When are we guaranteed a polynomial? Part 2</h2> <p>This section is a bit more technical, and focuses a bit more on the linear algebra aspect of things. Back when we were just discussing points, we only needed the values of \(x_1,\ldots,x_n\) to not be the same, and we would be guaranteed a solution.</p> <p>This is because our matrix of the form</p> \[\begin{equation} \begin{bmatrix} 1&amp;x_1&amp;x_1^2&amp;\dots&amp;x_1^{n-1}\\ 1&amp;x_2&amp;x_2^2&amp;\dots&amp;x_2^{n-1}\\ \vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\ 1&amp;x_n&amp;x_n^2&amp;\dots&amp;x_n^{n-1}\\ \end{bmatrix} \end{equation}\] <p>just so happens to be “invertible” when all the values of \(x_1,\ldots,x_n\) are different. This matrix actually has a special name, too. It is a Vandermonde matrix.</p> <p>There are a lot of things you can say about a square matrix which is invertible, but some of the most important things for us will be</p> <ol> <li>If a system of equations has an invertible coefficient matrix, then there is always exactly one unique solution guaranteed.</li> <li>If the coefficient matrix of a system is square but not invertible, then there are either no solutions, or infinitely many.</li> </ol> <p>There are a number of tests for invertibility, one computational method being to calculate the determinant. In practice, though, you will discover a matrix is <em>not</em> invertible when you either end up with a free variable or have conflicting equations.</p> <p>So if we’re just dealing with points, then we don’t have to worry about if we’ll be guaranteed a solution as long as our input points are all different. But, if we start dealing with more complicated constraints, then we will have to be a bit more careful.</p> <h3 id="an-example-without-a-unique-solution">An example without a unique solution</h3> <p>Take the example of wanting a polynomial passing through \((-1,-8)\) and \((3,8)\), while also having a relative extremum at \(x=1\).</p> <p>Three constraints means three coefficients. So we should be dealing with a quadratic.</p> \[\begin{array}{cccccc} p(x)&amp;=&amp;a_0&amp;+&amp;a_1x&amp;+&amp;a_2x^2\\ p'(x)&amp;=&amp;&amp;&amp;a_1&amp;+&amp;2a_2x \end{array}\] <p>The constraints give us \(p(-1)=-8,p(3)=8,p'(1)=0\). So our equations will be</p> \[\begin{array}{cccc} a_0&amp;+&amp;a_1(-1)&amp;+&amp;a_2(-1)^2&amp;=&amp;-8\\ a_0&amp;+&amp;a_1(3)&amp;+&amp;a_2(3)^2&amp;=&amp;8\\ &amp;&amp;a_1&amp;+&amp;2a_2(1)&amp;=&amp;0\\ \end{array}\] <p>Now I recommend trying to solve this system yourself so you can see what happens. But the row reduced version of the matrix form ends up being</p> \[\begin{equation} \left[ \begin{array}{ccc|c} 1&amp;0&amp;3&amp;0\\ 0&amp;1&amp;2&amp;0\\ 0&amp;0&amp;0&amp;1\\ \end{array} \right] \end{equation}\] <p>Which reads</p> \[\begin{array}{cccc} a_0&amp;&amp;+&amp;3a_2&amp;=&amp;0\\ &amp;a_1&amp;+&amp;2a_2&amp;=&amp;0\\ &amp;&amp;&amp;0&amp;=&amp;1\\ \end{array}\] <p>Uh-oh. That last equation doesn’t look right. That means there is no solution to this system.</p> <p>And when you look at it geometrically, that makes sense because no quadratic can possibly make that shape, since they are symmetric about their vertex. Both \(x=-1\) and \(x=3\) are an equal distance from \(x=1\), so any quadratic with a vertex at \(x=1\) will have the same value at \(x=-1\) as it does at \(x=3\).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/polynoquad.png" alt="" title=""> </div> </div> <p>As a simpler example of this, a quadratic with a vertex at \(x=0\) will look like \(p(x)=ax^2+c\). is it possible for \(p(1)\neq p(-1)\)? No! Because when we plug in \(p(1)\) and \(p(-1)\), we get the exact same output with each, \(p(\pm1)=a+c\).</p> <p>And indeed, the coefficient matrix</p> \[\begin{bmatrix} 1&amp;-1&amp;(-1)^2\\ 1&amp;3&amp;(3)^2\\ 0&amp;1&amp;2(1) \end{bmatrix}\] <p>has a determinant of zero. So if we had checked that prior, we would have seen that there would either be no quadratic, or infinitely many which would satisfy our conditions.</p> <p>So is all hope lost? For a single unique answer, yes. But there are infinitely many cubics which satisfy our constraints. Specifically, for some number \(t\), any cubic of the form \(\begin{equation} p(x)=x^3-3x-10+t(x^2-2x-3) \end{equation}\)</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/polyinf.png" alt="" title=""> </div> </div> <div class="caption"> $$p(x)=x^3-3x-10-5(x^2-2x-3)$$ <a href="https://www.desmos.com/calculator/gtnsl50lx8" target="_blank" rel="external nofollow noopener">Desmos Graph</a><br> </div> <p><br></p> <p>If you’re wondering how I got that, I just solved the system</p> \[\begin{array}{cccc} a_0&amp;+&amp;a_1(-1)&amp;+&amp;a_2(-1)^2&amp;+&amp;a_3(-1)^3&amp;=&amp;-8\\ a_0&amp;+&amp;a_1(3)&amp;+&amp;a_2(3)^2&amp;+&amp;a_3(3)^3&amp;=&amp;8\\ &amp;&amp;a_1&amp;+&amp;2a_2(1)&amp;+&amp;3a_3(1)^2&amp;=&amp;0\\ \end{array}\] <p>Now there are plenty of resources that can show you how exactly to solve a system with infinitely many solutions. So instead, I want to point out the conceptual significance the quadratic \(x^2-2x-3\) has to our problem.</p> <p>\(x^2-2x-3\) has a lot of interesting things going on at \(x\) values of our constraints. The zeros of this quadratic are \(x=-1\) and \(x=3\), and its vertex is at \(x=1\). This is no coincidence!</p> <p>Because the quadratic is zero at \(x=-1,3\), when we add any scalar multiple of it to our cubic \(x^3-3x-10\), it doesn’t change the value at those points. Since \(x^3-3x-10\) already passes through \((-1,-8)\) and \((3,8)\), then so will \(x^3-3x-10+t(x^2-2x-3)\).</p> <p>And because both the polynomials \(x^2-2x-3\) and \(x^3-3x-10\) have a relative extremum at \(x=1\), when we add a scalar multiple of the quadratic to the other, the result will still have a relative extremum there. If you know some calculus, I encourage you to try to explain why that is true.</p> <p>As a final note for this example, we could guarantee a unique solution for a cubic by just adding another requirement. For example, we could specify that \(p(1)=3\), or \(p(x_0)=y_0\) if you want to make it more arbitrary.</p> <hr> <h2 id="my-favorite-polynomial">My favorite polynomial</h2> <p>This section is more just about some tricks and shortcuts one might use for more complicated polynomials, including a real example which isn’t cherry picked to have a nice answer.</p> <p>This is the polynomial that I was questing to find when I first learned about polynomial interpolation (purely because it was pretty looking).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <img class="img-fluid rounded z-depth-1" src="/assets/img/polyfav.png" alt="" title=""> </div> </div> <div class="caption"> $$p(x)=\frac{-97x^7+2771x^5-53693x^3-2076975x}{864000}$$ <a href="https://www.desmos.com/calculator/wwyqykfi8t" target="_blank" rel="external nofollow noopener">Desmos Graph</a><br> </div> <p>I had drawn the shape and labeled the four points. And while the graph is quite beautiful, the equation itself is not.</p> <p>In total, the constraints were</p> \[\begin{array}{cc} p(-5)=3&amp;p'(-5)=0\\ p(-3)=5&amp;p'(-3)=0\\ p(3)=-5&amp;p'(3)=0\\ p(5)=-3&amp;p'(5)=0\\ p(0)=0 \end{array}\] <p>But to find it, I didn’t actually need to set it up with all 9 of these constraints. In fact, I only had to set up four equations!</p> <p>Instead of doing nine equations, I just noticed that I wanted an odd polynomial. So all the even coefficients \(a_0,a_2,\ldots,a_8\) need to be zero. Since that means it would be mirrored across the origin (including passing through it \(p(0)=0\)), I only needed the constraints \(p(3)=-5,p'(3)=0,p(5)=-3,p'(5)=0\), and the rest would follow from the nature of being odd.</p> <p>Four constraints, four coefficients. They would all have to be odd though, rather than just being a cubic polynomial. So that would total me up to a degree at most seven polynomial.</p> <p>My polynomial “guess” was</p> \[\begin{equation} p(x)=a_1x+a_3x^3+a_5x^5+a_7x^7 \end{equation}\] <p>In summary: if you know that you want your polynomial to satisfy some specific general condition, then make your “guess” reflect that. Similarly, a smart guess can simplify your equations significantly.</p> <p>As an example of what I mean, in our previous example of having extrema at \((-1,2)\) and \((1,-2)\), if instead of our guess being \(p(x)=a_0+a_1x+a_2x^2+a_3x^3\), we had chosen</p> \[p(x)=a_0+a_1(x-1)+a_2(x-1)^2+a_3(x-1)^3\] <p>You can verify that two of our equations would be <em>extremely</em> simple. Specifically, the equation for \(p(1)=-2\) is simply \(a_0=-2\), and the equation for \(p'(1)=0\) is just \(a_1=0\). So by making our guess a little strange, we simplified the solving process to really only needing to solve for <em>two</em> variables instead of four. The drawback is that to get our polynomial in standard form we have to expand it out and simplify after solving.</p> <hr> <h2 id="beyond-polynomials">Beyond polynomials</h2> <p>Just like we can set up our “guess” to be an even or odd polynomial, in general, you can use this interpolation method for other types of functions. Our polynomial structure was</p> \[\begin{equation} p(x)=a_0x^0+a_1x^1+a_2x^2+\ldots+a_{n-1}x^{n-1} \end{equation}\] <p>\(n\) coefficients means \(n\) constraints.</p> <p>But why limit ourselves to powers of \(x\) on our coefficients?</p> <p>What if I want a function with exponentials instead of polynomials?</p> \[\begin{equation} g(x)=a_0e^{0x}+a_1e^{1x}+a_{-1}e^{-1x}+a_2e^{2x}+a_{-2}e^{-2x}+\ldots+a_ne^{nx}+a_{-n}e^{-nx} \end{equation}\] <p>This particular setup would allow me \(2n+1\) constraints.</p> <p>The process is the same. Plug in your \(g(x_i)\) and set it equal to your desired \(y_i\). The coefficients aren’t quite as pretty, but you’re still just solving a system of equations.</p> <p>As an example, what if I want a function of the form \(g(x)=a_0+a_1e^{x}+a_{-1}e^{-x}\) that passes through the same points as our original quadratic, \((1,9),(2,7),(3,-1)\). Then my equations will still be</p> \[\begin{array}{cc} g(1)=9&amp;\implies&amp;a_0+a_1e^{1}+a_{-1}e^{-1}=9\\ g(2)=7&amp;\implies&amp;a_0+a_1e^{2}+a_{-1}e^{-2}=7\\ g(3)=-1&amp;\implies&amp;a_0+a_1e^{3}+a_{-1}e^{-3}=-1\\ \end{array}\] \[\left[ \begin{array}{ccc|c} 1&amp;e^1&amp;e^{-1}&amp;9\\ 1&amp;e^2&amp;e^{-2}&amp;7\\ 1&amp;e^3&amp;e^{-3}&amp;-1\\ \end{array} \right]\] <p>The answer is completely disgusting compared to the simple polynomial we got before, but the <a href="https://www.desmos.com/calculator/hppaude5hx" rel="external nofollow noopener" target="_blank">graphs</a> look quite similar.</p> <p>But why even force it to be linear? Why not create a rational function that satisfies \(n+m\) constraints?</p> \[\begin{equation}\label{rational} g(x)=\frac{a_0+a_1x+\ldots+a_{n-1}x^{n-1}}{b_0+b_1x+\ldots+b_{m-1}x^{m-1}+x^m} \end{equation}\] <p>Since the coefficients of rational functions are based on ratios rather than strict numbers, we can force it to be unique by having what would be \(b_m\) to be \(1\).</p> <p>Then we can still make it linear by multiplying the denominator to both sides and having our equations be of the form</p> \[\begin{equation}\label{rationalsys} a_0+a_1x+\ldots+a_{n-1}x^{n-1}-b_0g(x)-b_1xg(x)-\ldots-b_{m-1}x^{m-1}g(x)=x^mg(x) \end{equation}\] <p>For example, let’s say we want a rational function of the form \(g(x)=\frac{a_0}{b_0+b_1x}\) which passes through the points \(\left(-1,\frac{1}{2}\right)\) and \((2,-1)\). Now you may be thinking that we have three unknown coefficients, so we should be able to guarantee three points, right? Well, not quite. Our two equations would be</p> \[\begin{array}{cc} g(-1)=\frac{1}{2}&amp;\implies&amp;\frac{a_0}{b_0+b_1(-1)}=\frac{1}{2}\\ g(2)=-1&amp;\implies&amp;\frac{a_0}{b_0+b_1(2)}=-1\\ \end{array}\] <p>By multiplying out the denominator to both sides,</p> \[\begin{array}{cc} a_0&amp;=&amp;\frac{1}{2}(b_0+b_1(-1))\\ a_0&amp;=&amp;-1(b_0+b_1(2))\\ \end{array}\] <p>Getting everything to one side,</p> \[\begin{array}{cc} a_0&amp;-&amp;\frac{1}{2}b_0&amp;+&amp;\frac{1}{2}b_1&amp;=&amp;0\\ a_0&amp;+&amp;b_0&amp;+&amp;b_1(2)&amp;=&amp;0\\ \end{array}\] <p>This is what we call a “homogeneous” system, since everything on the right side is zero. Homogeneous systems always have at least one solution (one where every unknown is zero, called ‘the trivial solution’), and may have infinitely many. The trivial solution does <em>not</em> work for us, here. It doesn’t make sense for \(g(x)=\frac{0}{0+0x}\). So unless there does <em>happen</em> to be a nontrivial solution for your third point, then you’ll find there is no usable solution.</p> <p>In this case, there are infinitely many solutions because, as mentioned before, the coefficients on rational functions are based on ratios rather than concrete values. There are infinitely many ways to write a single rational function: \(\frac{a}{bx+c}=\frac{2a}{2bx+2c}\) for example. If we require that \(b_1=1\), then we will actually be guaranteed exactly one unique solution, since our equations could be</p> \[\begin{array}{cc} a_0&amp;-&amp;\frac{1}{2}b_0&amp;=&amp;-\frac{1}{2}\\ a_0&amp;+&amp;b_0&amp;=&amp;-2\\ \end{array}\] <p>From our general form \eqref{rational}, \(n=1\) and \(m=1\). Our system is indeed in the form \eqref{rationalsys}</p> \[\begin{array}{cc} a_0&amp;-&amp;b_0g(-1)&amp;=&amp;(-1)^1g(-1)\\ a_0&amp;-&amp;b_0g(2)&amp;=&amp;(2)^1g(2)\\ \end{array}\] <p>The solution to this system is \(a_0=-1,b_0=-1\), so</p> \[g(x)=-\frac{1}{x-1}\] <p>And here is the <a href="https://www.desmos.com/calculator/bxuygfb62f" rel="external nofollow noopener" target="_blank">graph</a>.</p> <p>Now solving these problems is considerably more difficult. We no longer have our trusty Vandermonde matrix, and our equations aren’t as pretty, so we have to be more careful in general. We are usually dealing with a lot more constants too, so we have to come up with more constraints if we want a unique solution, and have to solve much larger systems of equations.</p> <p>That said! It’s possible, and that’s really all that matters, isn’t it?</p> <p>So for all of you who are inspired, go forth and create beautiful graphs!</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: April 15, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>