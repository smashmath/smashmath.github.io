<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Intro To Solving Systems of First Order Differential Equations | smashmath</title> <meta name="author" content=" "> <meta name="description" content="An attempt at an intuitive derivation"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/firstordersystemsolve/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Intro To Solving Systems of First Order Differential Equations</h1> <p class="post-description">An attempt at an intuitive derivation</p> </header> <article> <p>Because this topic is usually taught pretty late in a differential equations course and requires some linear algebra, this post is aimed towards people who either already have some differential equations and/or linear algebra experience.</p> <p>If you don’t know much linear algebra, I would highly recommend looking into constant coefficient linear differential equations first before diving into this topic, since in many ways this is a continuation of/step up from that.</p> <p>On the other hand, if you are relatively comfortable with linear algebra and basic calculus but don’t know a lot about differential equations, this may be an easier differential equations topic to get your feet wet with.</p> <hr> <p>The goal here is to make the solving of the following type of differential equation intuitive:</p> <p>\begin{equation} \label{1} \vec{x}’(t)=A\vec{x}(t) \end{equation}</p> <p>This is a system of linear first-order homogeneous differential equations. Here \(\vec{x}(t)\) is a column vector of functions, and \(A\) is a square matrix. Before we tackle that, however, let’s examine the one-dimensional case, where \(A\) is just a number \(a\):</p> <p>\begin{equation}\label{1d} x’(t)=ax(t) \end{equation}</p> <p>This is what I would consider to be the most fundamental and important differential equation there is. Partly because if you have any experience with taking derivatives, you may just be able to figure out the solution.</p> <p>The way that I would look at this differential equation \eqref{1d} is the question</p> <p>“What function has the property that when I take the derivative, it is exactly the same as just multiplying by the constant \(a\)?”</p> <p>If you are unsure, maybe this specific example where \(a=1\) may be more familiar:</p> <p>\begin{equation}\label{et} f(t)=f’(t) \end{equation}</p> <p>Hopefully the function that comes to mind is \(f(t)=e^t\). And now maybe the answer to \eqref{1d} is a little more obvious. The chain rule tells us that if \(\frac{d}{dt}e^t=e^t\), then \(\frac{d}{dt}e^{at}=ae^{at}\). So maybe that’s just the solution? Well… yes but there are more.</p> <p>Notice that \(\frac{d}{dt}2e^t=2e^t\) also satisfies \eqref{et}. And in fact, no matter what the constant \(C\) is, \(f(t)=Ce^t\) will have the property that it it equal to its own derivative, making it a solution to \eqref{et}.</p> <p>Similarly, the general solution to \eqref{1d} is \(x(t)=Ce^{at}\). However, to be consistent with where we’re going, we are going to write it as \(x(t)=e^{at}C\), with the constant on the right side.</p> <p>So perhaps you’re looking at</p> \[\vec{x}'(t)=A\vec{x}(t)\] <p>and wondering if the solution is something like \(\vec{x}(t)=e^{At}\). And actually, it kind of is! One general solution is in fact \(\vec{x}(t)=e^{At}\vec{C}\). Here \(\vec{C}\) is a column vector of arbitrary constants. The only problem is that calculating \(e^{At}\) is usually <em>really</em> hard. And the work required to do it is actually the same work you’d do solving the system the normal way.</p> <p>So instead of solving these systems by calculating matrix exponentials, we need to talk about eigenvectors.</p> <h3 id="wait-what-the-heck-is-an-eigenvector">Wait, what the heck is an eigenvector?</h3> <p>Linear algebra is usually not a prerequisite for differential equations, so not everyone taking a DE class knows what an eigenvector is. However, the concept is not as new or unfamiliar as it sounds. An eigenvector \(\vec{v}\) of a matrix \(A\) with eigenvalue \(\lambda\) is a nonzero vector which satisfies the equation</p> <p>\begin{equation} A\vec{v}=\lambda \vec{v} \end{equation}</p> <p>This is really just asking the question</p> <p>“What vector has the property that when I multiply by the matrix \(A\), it is exactly the same as just multiplying by the constant \(\lambda\)?”</p> <p>That question sounds a bit familiar. But the answer to this question really depends on the matrix \(A\). And usually, there is more than one answer. A matrix with \(n\) rows and \(n\) columns can have up to \(n\) linearly independent eigenvectors.</p> <h3 id="but-how-do-we-find-eigenvectors">But how do we find eigenvectors?</h3> <p>Well if we start with the equation \(A\vec{v}=\lambda \vec{v}\), then we can move everything to one side of the equation.</p> \[A\vec{v}-\lambda\vec{v}=0\] <p>By writing out \(\lambda\vec{v}\) as \(\lambda I\vec{v}\), where \(I\) is the identity matrix which acts like the number \(1\),</p> \[I_2=\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix},\;I_3=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix},\ldots, I_n=\begin{bmatrix}1&amp;0&amp;0&amp;\dots&amp;0\\0&amp;1&amp;0&amp;\dots&amp;0\\0&amp;0&amp;1&amp;\dots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\0&amp;0&amp;0&amp;\dots&amp;1\end{bmatrix}\] <p>we can factor out the vector like so,</p> \[(A-\lambda I)\vec{v}=0\] <p>Now in linear algebra, there is something known as the “Equivalence theorem”, which give us about 25-30 different equivalent statements we can make about square matrices if they are “invertible” or not. For our purposes, we just need these two,</p> <ol> <li> <p>A square matrix \(X\) is invertible if and only if \(\det(X)\neq 0\).</p> </li> <li> <p>The system \(X\vec{v}=0\) has only the trivial solution (\(\vec{v}=0\)) if and only if \(X\) is invertible.</p> </li> </ol> <p>Combining these,</p> <p>The system \(X\vec{v}=0\) has only the trivial solution (\(v=0\)) if and only if \(\det(X)\neq 0\).</p> <p>Which also tells us</p> <p>The system \(X\vec{v}=0\) has a nontrivial solution (\(\vec{v}\neq0\)) if and only if \(\det(X)=0\).</p> <p>What does this mean? Well, if for some particular \(\lambda\) we have \(\det(A-\lambda I)\neq0\), then the only vector \(\vec{v}\) that satisfies</p> \[A\vec{v}=\lambda\vec{v}\] <p>is \(\vec{v}=0\). If \(\vec{v}=0\) then our only solution of the form \(\vec{v}e^{\lambda t}\) is \(0e^{\lambda t}=0\) which is not a solution we care about.</p> <p>All this to say, we need \(\det(A-\lambda I)=0\) for there to be an eigenvector with eigenvalue \(\lambda\). We call</p> \[\det(A-\lambda I)=0\] <p>the characteristic polynomial. And yes! This characteristic polynomial is very closely related to the characteristic polynomial you are familiar with when discussing linear constant coefficient differential equations. The roots of the characteristic equations are the eigenvalues of the matrix.</p> <h3 id="solving-the-system-of-differential-equations">Solving the system of differential equations</h3> <p>We’ve discussed two questions that the topics of eigenvectors, \(A\vec{v}=\lambda\vec{v}\), and differential equations such as \(x'(t)=\lambda x(t)\) essentially ask of us.</p> <p>1. “What <strong>vector</strong> has the property that when I <strong>multiply by the matrix</strong> \(A\), it is exactly the same as just multiplying by the constant \(\lambda\)?”</p> <p>2. “What <strong>function</strong> has the property that when I <strong>take the derivative</strong>, it is exactly the same as just multiplying by the constant \(\lambda\)?”</p> <p>As a reminder, the answer to the second question was \(ce^{\lambda t}\), since \(\frac{d}{dt}(ce^{\lambda t})=\lambda(ce^{\lambda t})\). Or to write it another way,</p> \[(ce^{\lambda t})'=\lambda(ce^{\lambda t})\] <p>The question that our system \(\vec{x}'(t)=A\vec{x}(t)\) asks is</p> <p>3. “What <strong>vector function</strong> has the property that when I <strong>take the derivative</strong>, it is exactly the same as just <strong>multiplying by the matrix</strong> \(A\)?”</p> <p>Which is just a mix of the other two questions.</p> <p>So we have two mathematical objects, a type of <strong>vector</strong> and a <strong>function</strong> with two similar properties.</p> \[\begin{align*} A\vec{v}&amp;=\lambda\vec{v}\\ \frac{d}{dt}e^{\lambda t}&amp;=\lambda e^{\lambda t}\\ \end{align*}\] <p>What if we just combine them directly? Consider the <strong>vector function</strong> \(\vec{x}(t)=\vec{v}e^{\lambda t}\).</p> \[\begin{align*} \frac{d}{dt}\vec{x}(t)&amp;=\frac{d}{dt}(\vec{v}e^{\lambda t})&amp;A\vec{x}(t)&amp;=A(\vec{v}e^{\lambda t})&amp;\\ \vec{x}'(t)&amp;=\left(\frac{d}{dt}e^{\lambda t}\right)\vec{v}&amp;A\vec{x}(t)&amp;=(A\vec{v})e^{\lambda t}&amp;\\ \vec{x}'(t)&amp;=(\lambda e^{\lambda t})\vec{v}&amp;A\vec{x}(t)&amp;=(\lambda\vec{v})e^{\lambda t}&amp;\\ \vec{x}'(t)&amp;=\lambda(\vec{v}e^{\lambda t})&amp;A\vec{x}(t)&amp;=\lambda(\vec{v}e^{\lambda t})&amp;\\ \vec{x}'(t)&amp;=\lambda \vec{x}(t)&amp;A\vec{x}(t)&amp;=\lambda \vec{x}(t)&amp;\\ \end{align*}\] \[\vec{x}'(t)=A\vec{x}(t)\] <p>So there it is. The solutions to these systems are obtained by multiplying an eigenvector of the matrix by an exponential with the eigenvalue in its power.</p> <p>And just like with linear differential equations you may be more familiar with solving, the general solution is a linear combination of each of your linearly independent solutions.</p> <p>So to summarize:</p> <ol> <li> <p>Find the roots of the characteristic polynomial \(\det(A-\lambda I)=0\), \(\lambda=\lambda_1,\lambda_2,\ldots,\lambda_n\)</p> </li> <li> <p>Solve the systems \((A-\lambda_i I)\vec{v}_i=0\) to get your eigenvectors</p> </li> <li> <p>The general solution will be \(\vec{x}(t)=c_1\vec{v}_1e^{\lambda_1 t}+\ldots+c_n\vec{v}_ne^{\lambda_n t}\)</p> </li> </ol> <p>Now there are some hiccups that you may run into. One being when an eigenvalue can be complex, and another that you not get \(n\) total eigenvectors. But this should hopefully be enough to get you started on most of the problems you are likely to encounter in an intro class.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: March 24, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>