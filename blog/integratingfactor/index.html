<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Integrating Factors Explained | smashmath</title> <meta name="author" content=" "> <meta name="description" content="the most common way to solve first order linear ODE's"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/integratingfactor/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Integrating Factors Explained",
      "description": "the most common way to solve first order linear ODE's",
      "published": "July 18, 2022",
      "authors": [
        {
          "author": "Taylor F.",
          "authorURL": "",
          "affiliations": [
            {
              "name": "None",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Integrating Factors Explained</h1> <p>the most common way to solve first order linear ODE's</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#what-is-a-first-order-linear-ode">What is a first order linear ODE</a></div> <div><a href="#how-do-we-solve-them">How do we solve them</a></div> <div><a href="#finding-the-integrating-factor">Finding the integrating factor</a></div> <ul> <li><a href="#a-detour-with-exponentials">A detour with exponentials</a></li> </ul> <div><a href="#solving-for-%CE%BC">Solving for μ</a></div> <div><a href="#solving-the-equation">Solving the equation</a></div> <div><a href="#unnecessary-further-simplifications">Unnecessary further simplifications</a></div> <div><a href="#further-notes">Further notes</a></div> </nav> </d-contents> <p>This is one of the first things taught in an intro to differential equations class, and I think it is very accessible to students who have taken basic calculus. The only snag might be that you may not know how to do the integral you inevitably obtain, but the overall idea for the process is straightforward enough, I think.</p> <p>As usual I kind of go overboard on the additional facts which you don’t really <em>need</em> to know. So just ignore them if you don’t care. I’ll put <strong>Aside</strong> in front of those kind of things.</p> <h2 id="what-is-a-first-order-linear-ode">What is a first order linear ODE?</h2> <p>A first order linear differential equation is one of the form</p> \[\begin{equation} y'+p(t)y=g(t) \end{equation}\] <p>Maybe you have a function on the \(y'\) term, but dividing it out gives the standard form above. An initial condition such as \(y(0)=3\) is also common, but that only needs to be worried about near the end of the solving process.</p> <p>We also won’t be concerning ourselves about where solutions to the equation (initial value problems) exist. That’s a bit too technical for the purposes of this post.</p> <p>We will also be using some compact prime notation. Basically</p> \[\begin{equation} \frac{d}{dt}(f(t)h(t))=(fh)' \end{equation}\] <h2 id="how-do-we-solve-them">How do we solve them?</h2> <p>Well, first, let’s review some basic calculus. Specifically, the product rule!</p> \[\begin{equation} (fh)'=fh'+f'h \end{equation}\] <p>The order doesn’t matter because it’s a sum. Now, observe what happens if we replace \(h\) with \(y\)</p> \[(fy)'=fy'+f'y\] <p>That looks sort of close to the left side of our original differential equation!</p> <p>So, the motivating idea is to find some function <a href="https://puu.sh/JbL0d/bbacfdb2ca.mp4" target="_blank" rel="external nofollow noopener">\(\mu(t)\)</a> which will make the left side of our equation a simple product rule. Because then we can integrate both sides and solve for \(y\).</p> <h2 id="finding-the-integrating-factor">Finding the integrating factor</h2> <p>Now, this is the idea behind almost every single technique you learn in a differential equations class: “<em>the solution probably looks like this, so let’s plug it in and solve for the unknowns</em>”.</p> <p>When we multiply our original equation by \(\mu\), we get</p> \[\mu y'+\mu p(t)y=\mu g(t)\] <p>And our goal, remember, is to get that left side to look like</p> \[\mu y'+p(t)\mu y=(fy)'\] <p>Well, if we expand it out, we get</p> \[\mu y'+p(t)\mu y=fy'+f'y\] <p>So, matching up the terms, we get that \(\mu=f\) and \(p(t)\mu=f'=\mu'\).</p> <p>Then, to solve for \(\mu\), we need to solve</p> \[\begin{equation} \mu'=p(t)\mu \end{equation}\] <p>Now, you can solve this differential equation in a lot of different ways. Usually as a separable equation. But instead of teaching you that technique which you may not know, I’m just going to show you the differentiation rule for exponentials:</p> <h3 id="a-detour-with-exponentials">A detour with exponentials</h3> \[\begin{equation} \left(e^{f(t)}\right)'=f'(t)e^{f(t)} \end{equation}\] <p>In words, the observation to make is that differentiating an exponential function is the same as multiplying it by some function. That is,</p> \[y'=f'(t)y\iff y=Ce^{f(t)}\] <p>Note that we can multiply by a constant since it doesn’t change anything about the differentiation.</p> <h2 id="solving-for-μ">Solving for μ</h2> <p>All this to say, we just need some function \(P(t)\) such that \(P'(t)=p(t)\). Basically, \(P(t)=\int p(t)dt\). Any one will do! <strong>Aside</strong>: This is because \(e^{P(t)+K}=Ce^{P(t)}\), and any scalar multiple of an integrating factor is also an integrating factor. So just pick one antiderivative and go with it.</p> <p>So, if we plug that into our differential equation,</p> \[e^{P(t)}y'+p(t)e^{P(t)}y=e^{P(t)}g(t)\] <p>We can verify that, under the assumption that \(P'(t)=p(t)\), the left side is indeed \(e^{P(t)}y'+p(t)e^{P(t)}y=\left(e^{P(t)}y\right)'\).</p> \[\left(e^{P(t)}y\right)'=e^{P(t)}g(t)\] <p>In summary, the basic equation for the integrating factor is</p> \[\begin{equation} \mu(t)=e^{\int p(t)dt} \end{equation}\] <h2 id="solving-the-equation">Solving the equation</h2> <p>Now, we can just integrate both sides (not forgetting our constant of integration).</p> \[e^{P(t)}y=C+\int e^{P(t)}g(t)dt\] <p>Finally, we can solve for \(y\) by dividing both sides by \(e^{P(t)}\) (or multiplying by \(e^{-P(t)}\)).</p> \[y=Ce^{-P(t)}+e^{-P(t)}\int e^{P(t)}g(t)dt\] <p><strong>Aside</strong>: One interesting observation is that we can express this solution more compactly in terms of \(\mu\).</p> \[y=\frac{C}{\mu}+\frac{\int \mu g}{\mu}\] <p>And if you’re in differential equations or basic calculus now, your professor may not like this more compact way of writing the integral without the d(whatever). But the textbook I used for my intro to analysis class (Understanding Analysis by Stephen Abbott) used it, so just tell your professor that you’re using Abbott (i.e. big brain advanced baller) notation (and then don’t blame me if your professor isn’t having that).</p> <h2 id="unnecessary-further-simplifications">Unnecessary further simplifications</h2> <p>The rest of the post is an <strong>aside</strong>. This is just gravy if you’re still interested in knowing more and going further with these ideas. The post is over; you can leave and go home now if you want.</p> <p>There are some other simplifications you can make which I personally like. They aren’t really super practical in terms of actually solving these equations, usually, but I think they’re cool!</p> <p>Personally, I like to use dummy variables for integration.</p> \[y=Ce^{-P(t)}+e^{-P(t)}\int_{t_0}^t e^{P(s)}g(s)ds\] <p>We can also use another dummy variable \(P(t)\):</p> \[P(t)=\int_{t_0}^tp(r)dr\] <p>Also using that \(P(s)=\int_{t_0}^sp(r)dr\). Changing our solution to</p> \[y=Ce^{-\int_{t_0}^tp(r)dr}+e^{-\int_{t_0}^tp(r)dr}\int_{t_0}^t e^{\int_{t_0}^sp(r)dr}g(s)ds\] <p>This has the added benefit of making it so that we can replace \(C\) with \(y(t_0)\). This is because plugging in \(t=t_0\) makes all the integrals zero, leaving us with just \(C\). This eliminates the need to solve for \(C\) in an initial value problem. Just be careful that the integrals do not diverge when integrating from \(t_0\). If they do, choose any other arbitrary starting bound that gives a convergent (gucci) integral.</p> \[y=y(t_0)e^{-\int_{t_0}^tp(r)dr}+e^{-\int_{t_0}^tp(r)dr}\int_{t_0}^t e^{\int_{t_0}^sp(r)dr}g(s)ds\] <p>We may also distribute the exponential into the integral now, because we are using a dummy variable for the integration. Note that in the exponent we will get</p> \[\int_{t_0}^sp(r)dr-\int_{t_0}^tp(r)dr\] <p>Which we can simplify to \(\int_t^{t_0}p(r)dr+\int_{t_0}^sp(r)dr=\int_{t}^sp(r)dr\) using our rules for integration.</p> \[y=y(t_0)e^{-\int_{t_0}^tp(r)dr}+\int_{t_0}^t e^{\int_{t}^sp(r)dr}g(s)ds\] <p>Another personal preference is to use \(\exp(x)\) instead of \(e^x\) when the exponent is big and messy (such as when we stick a whole integral up in there).</p> \[y=y(t_0)\exp\left(-\int_{t_0}^tp(r)dr\right)+\int_{t_0}^t\exp\left(\int_{t}^sp(r)dr\right)g(s)ds\] <h2 id="further-notes">Further notes</h2> <p>Here’s some more information on how this concept generalizes to second order equations, if you’re interested.</p> <p>Did you know every linear second order differential equation also has an integrating factor? The reason nobody ever uses this, though, is that, usually, finding it is just as hard as solving the equation normally.</p> <p>For example, trying to use an integrating factor to solve</p> \[y''+y=0\] <p>ends up giving you the following differential equation for the integrating factor \(\mu\):</p> \[\mu''+\mu=0\] <p>Which means that the integrating factor for the differential equation must be a solution to the differential equation. Making this method absolutely useless for this problem.</p> <p>If you want to know how the method works, though, basically the idea is to find a function \(\mu\) and \(f\) such that when you multiply \(P(t)y''+Q(t)y'+R(t)y\) by \(\mu\), you get</p> \[P(t)\mu y''+Q(t)\mu y'+R(t)\mu y=(P(t)\mu y'+fy)'\] <p>Setting equal the coefficients gives you</p> \[f'=R\mu,\quad P\mu'+P'\mu+f=Q\mu\] <p>If you differentiate the right equation and substitute in \(R\mu\) for \(f'\), you get</p> \[P\mu''+(2P'-Q)\mu'+(P''-Q'+R)\mu=0\] <p>This is also called the Adjoint Equation, and it’s usually not much nicer than the original. If \(P''-Q'+R=0\), though, then the adjoint equation is first order (and linear) in \(\mu'\), allowing you to solve it either with another integrating factor or as a separable equation. When this happens, the original equation is called “exact” (yes, this is the second order version of exact equations!).</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 29, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>