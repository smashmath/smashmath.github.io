<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>2x2 Matrix Exponential Formulas with Differential Equations | smashmath</title> <meta name="author" content=" "> <meta name="description" content="i do math sometimes "> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/2x2matrixexpwde/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "2x2 Matrix Exponential Formulas with Differential Equations",
      "description": "",
      "published": "December 8, 2021",
      "authors": [
        {
          "author": "Taylor Grant",
          "authorURL": "",
          "affiliations": [
            {
              "name": "None",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>2x2 Matrix Exponential Formulas with Differential Equations</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#formulas">Formulas</a></div> <div><a href="#proofs">Proofs</a></div> <ul> <li><a href="#intro">Intro</a></li> <li><a href="#distinct-eigenvalues">Distinct Eigenvalues</a></li> <li><a href="#complex-conjugate-eigenvalues">Complex Conjugate Eigenvalues</a></li> <li><a href="#one-defective-eigenvalue">One Defective Eigenvalue</a></li> <li><a href="#one-nondefective-eigenvalue">One Nondefective Eigenvalue</a></li> </ul> <div><a href="#applications">Applications</a></div> <div><a href="#closing-remarks">Closing Remarks</a></div> </nav> </d-contents> <details> <summary style="color:white;">This is a rewrite</summary> <p>This is a rewrite of an <a href="../ezmatrixexp" target="_blank">older post</a> I made a while ago. At the time I thought Laplace Transforms were the best way to do this, but I've come to realize that the best way is using the method outlined in <a href="../matrixexpwde" target="_blank">this post</a> using normalized solutions.</p> </details> <p><strong>WARNING</strong>: If you are in a differential equations class right now, turn back. This is black magic that your professor <em>will not</em> want you to memorize or use on their tests. These are just cool and/or for the convenience of those who evaluate a lot of matrix exponentials, as I do.</p> <h1 id="formulas">Formulas</h1> <p>Let \(A\) be a \(2\times 2\) matrix.</p> <p>If \(A\) has two distinct eigenvalues \(\lambda_1,\lambda_2\), then</p> \[\begin{equation} \label{form1} e^{At}=\frac{e^{\lambda_2t}(A-\lambda_1I)-e^{\lambda_1t}(A-\lambda_2I)}{\lambda_2-\lambda_1} \end{equation}\] <p>Or alternatively,</p> \[\begin{equation} \label{form1a} e^{At}=\frac{\lambda_2e^{\lambda_1t}-\lambda_1e^{\lambda_2t}}{\lambda_2-\lambda_1}I + \frac{e^{\lambda_2t}-e^{\lambda_1t}}{\lambda_2-\lambda_1}A \end{equation}\] <p>If \(A\) has a real determinant, \(\operatorname{tr}(A)=0\), and \(\det(A)&lt;0\), then an eigenvalue of \(A\) is \(\lambda=\sqrt{-\det(A)}\), and</p> \[\begin{equation} \label{form1b} e^{At}=\cosh(\lambda t)I+\frac{\sinh(\lambda t)}{\lambda}A \end{equation}\] <p>If \(A\) is singular and has a nonzero trace,</p> \[\begin{equation}\label{form1c} e^{At}=\frac{e^{\operatorname{tr}(A)t}A-(A-\operatorname{tr}(A)I)}{\operatorname{tr}(A)} \end{equation}\] \[\begin{equation}\label{form1cb} e^{At}=I+\frac{e^{\operatorname{tr}(A)t}-1}{\operatorname{tr}(A)}A \end{equation}\] <p>If \(A\) is real and has complex conjugate eigenvalues \(a \pm bi\), then</p> \[\begin{equation}\label{form2a} e^{At}=e^{a t}\left(\cos(b t)I+\frac{\sin(b t)}{b }(A-a I)\right) \end{equation}\] \[\begin{equation} \label{form2b} e^{At}=\frac{e^{at}}{b}\bigg(b\cos(b t)I+\sin(b t)(A-a I)\bigg) \end{equation}\] <p>If \(A\) has one defective eigenvalue \(\lambda\), then</p> \[\begin{equation} \label{form3} e^{At}=e^{\lambda t}\left(I+t(A-\lambda I)\right) \end{equation}\] <p>And if \(A\) has only one eigenvalues \(\lambda\) which is not defective (meaning \(A=\lambda I\)) then</p> \[\begin{equation} \label{form4} e^{\lambda It}=e^{\lambda t}I \end{equation}\] <h1 id="proofs">Proofs</h1> <p>I would not say it’s required reading, but to prove these formulas, we are going to primarily use <a href="../matrixexpwde" target="_blank">this post</a>. The method outlined in that post utilizes the <a href="../normalized" target="_blank">normalized solutions</a> of the linear differential equation obtained from the characteristic polynomial. This is ideal for \(2\times2\) matrices, because second order equations have very easy normalized solutions relative to anything of higher order. Since these normalized solutions are easy to remember, it makes these exponential formulas easy to remember too (if you know them).</p> <h2 id="intro">Intro</h2> <p>Quick summary for those who don’t want to read the other posts but also kind of want to know what’s going on: normalized solutions are solutions to differential equations which are ideal to solve initial value problems. Take the example \(y_1=\cos(t),y_2=\sin(t)\). The general solution \(\phi(t)\) to the initial value problem</p> \[y''+y=0,\,y(0)=y_0,y'(0)=y'_0\] <p>can be written conveniently as</p> \[\phi(t)=y_0\cos(t)+y'_0\sin(t)\] <p>In short, the coefficients are just the initial conditions. Specifically, they satisfy the two initial value problems</p> \[Y_1''+Y_1=0,\,Y_1(0)=1,Y_1'(0)=0\] \[Y_2''+Y_2=0,\,Y_2(0)=0,Y_2'(0)=1\] <p>My post on <a href="../normalized" target="_blank">normalized solutions</a> covers ways to get them, but I’ll just give them to you in the following section. Observe, though, that the initial conditions form the identity matrix <img class="emoji" title=":eyes:" alt=":eyes:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f440.png" height="20" width="20"></p> <p>The way we can use these normalized solutions to get our matrix exponential is done by considering \(e^{At}\) to be the solution \(\Phi(t)\) to the initial value problem</p> \[\begin{equation} \label{matrixIVP} \textbf{X}''+b\textbf{X}'+c\textbf{X}=0,\,\textbf{X}(0)=I,\textbf{X}'(0)=A \end{equation}\] <p>Where \(\lambda^2+b\lambda+c=\det(A-\lambda I)\) is the characteristic polynomial of \(A\).</p> <p>Why can we do this? Without getting too technical, this comes from the Cayley–Hamilton theorem which tells us that \(A\) satisfies it’s own characteristic polynomial (actually the minimal polynomial but we don’t have to worry about that for this post). Say the characteristic polynomial of \(A\) is \(\lambda^2+b\lambda+c=0\), then it is a fact that \(A^2+bA+cI=0\).</p> <p>So just as \(e^{rt}\) is a solution to \(x''+bx'+cx=0\) if \(r^2+br+c=0\), we can say that if \(A^2+bA+cI=0\), then \(e^{At}\) is a solution to \(\textbf{X}''+b\textbf{X}'+c\textbf{X}=0\).</p> <p>Therefore, if we can find our normalized solutions \(Y_1,Y_2\), then we can use the uniqueness of the solution of the initial value problem \eqref{matrixIVP} to say that</p> \[\begin{equation} \label{normform} e^{At}=Y_1(t)I+Y_2(t)A \end{equation}\] <p>Again, you may read <a href="../matrixexpwde" target="_blank">the other post</a> if you want to see a more rigorous proof of this.</p> <h2 id="distinct-eigenvalues">Distinct Eigenvalues</h2> <p>Given the differential equation</p> \[y''+by'+cy=0\] <p>If \(\lambda^2+b\lambda+c=0\) has two distinct roots \(\lambda_1,\lambda_2\), the normalized solutions will be</p> \[\begin{gather} Y_1(t)=\frac{\lambda_2e^{\lambda_1t}-\lambda_1e^{\lambda_2t}}{\lambda_2-\lambda_1}\\ Y_2(t)=\frac{e^{\lambda_2t}-e^{\lambda_1t}}{\lambda_2-\lambda_1} \end{gather}\] <p>Thus, by \eqref{normform}, we obtain \eqref{form1a}</p> \[e^{At}=\frac{\lambda_2e^{\lambda_1t}-\lambda_1e^{\lambda_2t}}{\lambda_2-\lambda_1}I + \frac{e^{\lambda_2t}-e^{\lambda_1t}}{\lambda_2-\lambda_1}A\] <p>We may then group terms to get \eqref{form1}.</p> \[e^{At}=\frac{e^{\lambda_2t}(A-\lambda_1I)-e^{\lambda_1t}(A-\lambda_2I)}{\lambda_2-\lambda_1}\quad \blacksquare\] <p>Note that if \(A\) is a complex matrix with complex eigenvalues that <em>are not</em> conjugates of each other, then \eqref{form1} will still work and be the best option.</p> <p>Now for some bonus equations… First, if \(\det(A)\) is real and strictly less than zero, and \(\operatorname{tr}(A)=0\), then \(\lambda_1=-\lambda_2=\sqrt{-\det(A)}\). This simplifies \eqref{form1a} to \eqref{form1b}.</p> \[\begin{equation} e^{At}=\cosh(\lambda t)I+\frac{\sinh(\lambda t)}{\lambda}A \end{equation}\] <p>If \(A\) is singular and the other eigenvalue is not also zero, this simplifies to \eqref{form1c}</p> \[\begin{equation} e^{At}=I+\frac{e^{\operatorname{tr}(A)t}-1}{\operatorname{tr}(A)}A \end{equation}\] <p>The best part of this particular formula is that it actually holds for all square rank-one matrices regardless of size (as long as \(\operatorname{tr}(A)\neq0\;\)!)</p> <p>Bonus: Since \(e^{(A+kI)t}=e^{kt}e^{At}\), then if \(B=A+kI\) where \(A\) is a rank one matrix with a nonzero trace, then you can still use the above formula, just multiply by \(e^{kt}\). That is to say, <em>any</em> matrix which is a scalar matrix (\(kI\)) away from a rank-one matrix (with a nonzero trace) can use this above formula, no matter the size.</p> <h2 id="complex-conjugate-eigenvalues">Complex Conjugate Eigenvalues</h2> <p>Given the differential equation</p> \[y''+by'+cy=0\] <p>If \(\lambda^2+b\lambda+c=0\) has complex conjugate roots \(a\pm bi\), the normalized solutions will be</p> \[\begin{gather} Y_1(t)=e^{at}\left(\cos(bt)-\frac{a}{b}\sin(bt)\right)\\ Y_2(t)=\frac{e^{at}}{b}\sin(bt) \end{gather}\] <p>Then, by \eqref{normform},</p> \[e^{At}=e^{at}\left(\cos(bt)-\frac{a}{b}\sin(bt)\right)I +\frac{e^{at}}{b}\sin(bt)A\] <p>Factoring out the \(e^{at}\) and combining like terms, we obtain \eqref{form2a}</p> \[e^{At}=e^{a t}\left(\cos(b t)I+\frac{\sin(b t)}{b }(A-a I)\right)\] <p>And arriving at \eqref{form2b} when we factor out \(\frac{1}{b}\) from both terms.</p> \[e^{At}=\frac{e^{at}}{b}\bigg(b\cos(b t)I+\sin(b t)(A-a I)\bigg)\] <h2 id="one-defective-eigenvalue">One Defective Eigenvalue</h2> <p>Given the differential equation</p> \[y''+by'+cy=0\] <p>If \(\lambda^2+b\lambda+c=0\) has a repeated root \(\lambda\), the normalized solutions will be</p> \[\begin{gather} Y_1(t)=(1-\lambda t)e^{\lambda t}\\ Y_2(t)=te^{\lambda t} \end{gather}\] <p>We use \eqref{normform} to get</p> \[e^{At}=(1-\lambda t)e^{\lambda t}I+te^{\lambda t}A\] <p>Factor out \(e^{\lambda t}\) to get \eqref{form3}</p> \[\begin{equation} e^{At}=e^{\lambda t}\left(I+t(A-\lambda I)\right)\quad \blacksquare \end{equation}\] <p>An alternate derivation can be done by using that \((A-\lambda I)^2=0\), allowing \(e^{At}\) to be computed directly as \eqref{form3}.</p> <h3 id="one-nondefective-eigenvalue">One Nondefective Eigenvalue</h3> <p>This only occurs when \(A\) is a scalar matrix, so there’s no need to use normalized solutions, but it’s also technically a case so it’s worth mentioning. So let’s say that \(A=\lambda I\). Then</p> \[e^{At}=\sum_{n=0}^\infty \frac{(\lambda tI)^n}{n!}\] \[e^{At}=\sum_{n=0}^\infty \frac{(\lambda t)^n}{n!}I^n\] \[e^{At}=\left(\sum_{n=0}^\infty \frac{(\lambda t)^n}{n!}\right)I=e^{\lambda t}I\] <p>Thus, \eqref{form4}</p> \[e^{\lambda It}=e^{\lambda t}I\] <h1 id="applications">Applications</h1> <p>For ways to apply matrix exponentials to solve \(2\times2\) systems of differential equations, check out <a href="../firstordersystemsquick" target="_blank">this post</a> on solving them like a baller.</p> <h2 id="closing-remarks">Closing Remarks</h2> <p>I enjoyed verifying that taking the derivative of these formulas is indeed the same as multiplying by \(A\).</p> \[\begin{equation} \frac{d}{dt}e^{At}=Ae^{At} \end{equation}\] <p>If you choose to attempt to do so as well, you will need the Cayley-Hamilton theorem.</p> <p>Even more fun than that is verifying that substituting \(-t\) for \(t\) does in fact give the inverse.</p> \[\begin{equation} e^{At}e^{-At}=I\implies e^{-At}=\left(e^{At}\right)^{-1} \end{equation}\] </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: November 12, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>