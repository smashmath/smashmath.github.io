<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Systems of Linear Difference Equations | smashmath</title> <meta name="author" content=" "> <meta name="description" content="Like systems of ODEs, but discrete ðŸ‘€"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/discretesystems/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Systems of Linear Difference Equations",
      "description": "Like systems of ODEs, but discrete ðŸ‘€",
      "published": "December 14, 2021",
      "authors": [
        {
          "author": "Taylor F.",
          "authorURL": "",
          "affiliations": [
            {
              "name": "None",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Systems of Linear Difference Equations</h1> <p>Like systems of ODEs, but discrete ðŸ‘€</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#intro">Intro</a></div> <ul> <li><a href="#solution-behavior">Solution Behavior</a></li> <li><a href="#new-solution-behaviors">New Solution Behaviors</a></li> </ul> <div><a href="#the-best-solution">The Best Solution</a></div> <div><a href="#solution-comparison-2x2">Solution Comparison (2x2)</a></div> <ul> <li><a href="#nondefective-repeated">Nondefective Repeated</a></li> <li><a href="#rank-1">Rank 1</a></li> <li><a href="#defective">Defective</a></li> <li><a href="#complex">Complex</a></li> <li><a href="#zero-trace">Zero Trace</a></li> <li><a href="#singular">Singular</a></li> <li><a href="#distinct">Distinct</a></li> </ul> </nav> </d-contents> <h1 id="intro">Intro</h1> <p>In differential equations, students learn about the system</p> \[\textbf{x}'(t)=A\textbf{x}(t)\] <p>But here we will discuss the discrete system</p> \[\textbf{x}(n+1)=A\textbf{x}(n)\] <p>Where \(n\in\mathbb{Z}_0^+\), and instead of a continuous function, we get a discrete set of points</p> \[\textbf{x}(0),\textbf{x}(1),\ldots,\textbf{x}(n),\ldots\] <h2 id="solution-behavior">Solution Behavior</h2> <p>With systems of DEs, its the sign of the eigenvalues that tells you the behavior. Negative is asymptotically stable (going to zero), positive is unstable, and zero is statically stable.</p> <p>However, in these discrete systems, itâ€™s the <em>magnitude</em>. To understand why, we need to know what our solutions even look like!</p> <p>With systems of DEs, the basic example is</p> \[x'(t)=ax(t)\] <p>Which has the solution \(x(t)=ce^{at}\). Therefore, its the sign of \(a\) which determines the behavior. However, with the discrete system</p> \[x(n+1)=ax(n)\] <p>the solutions are of the form \(x(t)=ca^n\). So we still get the behavior of asymptotically stable (going to zero), unstable, and types of static stability, but itâ€™s not about the sign anymore, and there are some new types of behavior. I encourage you to try and think about what the differences could be before reading on! Itâ€™s an interesting thing to try to reason out, in my opinion.</p> <p>Repeatedly multiplying a number \(a\) to some nonzero initial number \(c\) gets big when \(| a | &gt; 1\), goes to zero when \(|a|&lt;1\), and has a consistent magnitude when \(|a|=1\).</p> <p>But the similarities donâ€™t stop there. The solutions are still generally obtained by finding eigenvectors and eigenvalues, just like with DE systems. But instead of having solutions of the form \(\textbf{x}(t)=ce^{\lambda t}\textbf{v}\), they are of the form \(\textbf{x}(n)=c\lambda^n\textbf{v}\).</p> <h3 id="new-solution-behaviors">New Solution Behaviors</h3> <p>That said, there are type of behavior fpr discrete systems which does not occur for systems of ODEs. Specifically, if \(a\leq0\).</p> <p>When \(a&lt;0\), our solution is \((-a)^n=(-1)^na^n\), giving us an alternating pattern where each iteration flips its sign. This creates a sense of bouncing back and forth. With \(a&lt;-1\), itâ€™s bouncing back and forth with ever increasing magnitude. With \(-1&lt;a&lt;0\), itâ€™s bouncing back and forth towards the origin. And if \(a=-1\), itâ€™s simply bouncing back and forth without getting closer or further away.</p> <p>When \(a=0\), solutions of this type start constant, and then immediately disappear after finitely many iterations. For this reason, it is convenient to explicitly define the function \(0^x\) in the following way</p> \[\begin{equation} 0^x=\begin{cases}1,&amp;x=0\\0,&amp;x\neq0\end{cases} \end{equation}\] <p>Now, I am not saying that \(0^0=1\) always. It is indeed an indeterminate form. However, for our purposes, everything is simply cleaner if we take that as fact. Notice that we make the same assumption when we choose to write \(e^x\) as \(e^x=\sum_{n=0}^\infty\frac{x^n}{n!}\) rather than \(e^x=1+\sum_{n=1}^\infty\frac{x^n}{n!}\).</p> <p>I know which one I prefer. <img class="emoji" title=":unamused:" alt=":unamused:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f612.png" height="20" width="20"></p> <p>Either way, the most interesting similarity, in my opinion, is the analog for the matrix exponential.</p> <h1 id="the-best-solution">The Best Solution</h1> <p>In the system</p> \[\textbf{x}'(t)=A\textbf{x}(t)\] <p>the best general solution, though not always the most ideal to find, is</p> \[\textbf{x}(t)=e^{At}\textbf{x}(0)\] <p>Similarly, for the system</p> \[\textbf{x}(n+1)=A\textbf{x}(n)\] <p>the best general solution is</p> \[\textbf{x}(n)=A^n\textbf{x}(0)\] <p>Now, this is the coolest part, in my opinion.</p> <p>There are formulas for \(A^n\) which look nearly <em>identical</em> to the formulas for <a href="../2x2ezmatrixexp/" target="_blank">Matrix Exponentials</a> that I found. I will compare them here, but first! I would like to let you in on how I found them. I used the method described in <a href="../2x2ezmatrixexp/#another-approach">that matrix exponential post</a>. Basically, if the characteristic polynomial is \(s^2=p_0+p_1s\), solve</p> \[\begin{pmatrix} x(n+1)\\y(n+1) \end{pmatrix}= \begin{pmatrix} 0&amp;p_0\\1&amp;p_1 \end{pmatrix} \begin{pmatrix} x(n)\\y(n) \end{pmatrix},\quad \textbf{x}(0)= \begin{pmatrix} 1\\0 \end{pmatrix}\] <p>Then \(A^n=x(n)I+y(n)A\) (for 2x2s!). This does generalize, and I will at some point make a post about that.</p> <p>Theoretically, Iâ€™m fairly certain you can achieve the same results by solving for the <a href="/math/normalized" target="_blank">normalized solutions</a> of the linear difference equation</p> \[a_{n+2}-p_1a_{n+1}-p_0a_n=0\] <h1 id="solution-comparison-2x2">Solution Comparison (2x2)</h1> \[\begin{array}{cccccccc} \textbf{x}'(t)&amp;=&amp;A\textbf{x}(t)&amp;\implies&amp;\textbf{x}(t)&amp;=&amp;e^{At}\textbf{x}(0)\\ \textbf{x}(n+1)&amp;=&amp;A\textbf{x}(n)&amp;\implies&amp;\textbf{x}(n)&amp;=&amp;A^n\textbf{x}_0 \end{array}\] <p>The following two are quite simple, and we actually used them to find the matrix exponential formula.</p> <h2 id="nondefective-repeated">Nondefective Repeated</h2> <p>This occurs when \(A=kI\).</p> \[\begin{array}{ccc} e^{kIt}&amp;=&amp;e^{kt}I\\ (kI)^n&amp;=&amp;k^nI \end{array}\] <h2 id="rank-1">Rank 1</h2> <p>If \(A\) is any square matrix of rank one that also has a nonzero trace.</p> \[\begin{array}{ccccc} e^{At}&amp;=&amp;\frac{e^{\operatorname{tr}(A)t}A-(A-\operatorname{tr}(A)I)}{\operatorname{tr}(A)}&amp;=&amp;I+\frac{e^{\operatorname{tr}(A)t}-1}{\operatorname{tr}(A)}A\\ A^n&amp;=&amp;\frac{\operatorname{tr}(A)^nA-0^n(A-\operatorname{tr}(A)I)}{\operatorname{tr}(A)}&amp;=&amp;0^nI+\frac{\operatorname{tr}(A)^n-0^n}{\operatorname{tr}(A)}A \end{array}\] <p>As you can see, defining \(0^n\) as we did makes things very convenient, and allows us to take advantage of the underlying similarities between the two system types.</p> <h2 id="defective">Defective</h2> <p>If \(A\) is any \(2\times2\) matrix with a defective eigenvalue \(k\neq0\),</p> \[\begin{array}{ccc} e^{At}&amp;=&amp;e^{kt}\bigg(I+t\big(A-kI\big)\bigg)\\ A^n&amp;=&amp;k^n\bigg(I+\frac{n}{k}\big(A-kI\big)\bigg) \end{array}\] <p>If \(k=0\), then the solution is kind ofâ€¦ disturbing.</p> \[\begin{array}{ccc} e^{At}&amp;=&amp;I+tA\\ A^n&amp;=&amp;0^nI+0^{n-1}A \end{array}\] <p>But looking at it, it does <em>actually</em> work. At \(n=0\) itâ€™s \(I\), and at \(n=1\) itâ€™s \(A\), and then its zero ever after. Which is indeed what happens with this kind of matrix (nilpotent). Iâ€™m not writing \(0^n(I+0^{-1}A)\), though. This is clearly not a case where we can use regular exponent rules.</p> <h2 id="complex">Complex</h2> <p>If \(A\in\mathbb{R}^{2\times2}\) has complex eigenvalues \(a\pm bi=re^{\pm i\theta}\), then</p> \[\begin{align*} e^{At}=&amp;e^{at}\bigg(\cos(bt)I+\frac{\sin(bt)}{b}\big(A-aI\big)\bigg)\\ A^n=&amp;r^n\bigg(\cos(\theta n)I+\frac{\sin(\theta n)}{b}\big(A-aI\big)\bigg) \end{align*}\] <h2 id="distinct">Distinct</h2> <p>If \(A\) has two distinct eigenvalues \(\lambda_1,\lambda_2\), then</p> \[\begin{align*} e^{At}=&amp;\frac{e^{\lambda_2t}(A-\lambda_1I)-e^{\lambda_1t}(A-\lambda_2I)}{\lambda_2-\lambda_1}\\ A^n=&amp;\frac{\lambda_2^n(A-\lambda_1I)-\lambda_1^n(A-\lambda_2I)}{\lambda_2-\lambda_1} \end{align*}\] </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2025 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: January 14, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>