<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Skipping Integration by Parts Using Euler's Formula | smashmath</title> <meta name="author" content=" "> <meta name="description" content="skip or simplify integrals involving trig functions multiplied by exponentials"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/eulersformulabyparts/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Skipping Integration by Parts Using Euler's Formula</h1> <p class="post-description">skip or simplify integrals involving trig functions multiplied by exponentials</p> </header> <article> <p>So here I want to use Euler’s formula to skip the need to do the annoying recursive Integration by Parts for the following types of integrals \(\newcommand{\a}{\alpha }\) \(\newcommand{\b}{\beta }\) \(\newcommand{\Re}{\operatorname{Re}}\) \(\newcommand{\Im}{\operatorname{Im}}\) \(\newcommand{\conj}[1]{\overline{#1}}\)</p> \[\begin{equation} \int e^{at}\cos(bt)\,dt\quad\int e^{at}\sin(bt)\,dt \end{equation}\] <p>This can also be used more generally to simplify the integration by parts for integrals like</p> \[\begin{equation} \int f(t)e^{at}\cos(bt)\,dt\quad\int f(t)e^{at}\sin(bt)\,dt \end{equation}\] <p>Imagine doing integration by parts for</p> \[\int t^2e^{3t}\cos(4t)\,dt\] <p>It would be horrible. But what about integrating something like \(\int t^2e^{ct}\,dt\)? That’s a <strong>lot</strong> more reasonable. Well… if we let \(c=3+4i\) then that will actually solve the other integral!</p> <p>Now you may be thinking: “What is this sorcery, magic man?” And I’ll tell you exactly what it is.</p> <h1 id="eulers-formula"><strong>Euler’s Formula</strong></h1> <p>If you don’t know what it is, this is an <a href="../eulersformula/" target="_blank">explanation</a> of it. But the formula is</p> \[\begin{equation} e^{ix}=\cos(x)+i\sin(x) \end{equation}\] <h2 id="skipping-integration-by-parts">Skipping Integration by Parts</h2> <p>With this method, it’s possible to do the integrals</p> \[\begin{equation} \int e^{at}\cos(bt)\,dt\quad\int e^{at}\sin(bt)\,dt \end{equation}\] <p><em>in your head</em> without memorizing any formulas. The first step is to realize that \(e^{at}\cos(bt)\) and \(e^{at}\sin(bt)\) are simply the two parts of one simple complex exponential, \(e^{(a+bi)t}\).</p> \[\begin{equation} e^{(a+bi)t}=e^{at}\cos(bt)+ie^{at}\sin(bt) \end{equation}\] <p>Integrating the left side is incredibly easy, and if we can do the left side, we can do the right side too.</p> \[\begin{align*} \int e^{(a+bi)t}\,dt&amp;=\int\left[ e^{at}\cos(bt)+ie^{at}\sin(bt))\right]\,dt \\ \int e^{(a+bi)t}\,dt&amp;=\int e^{at}\cos(bt)\,dt+\int ie^{at}\sin(bt))\,dt \\ \int e^{(a+bi)t}\,dt&amp;=\int e^{at}\cos(bt)\,dt+i\int e^{at}\sin(bt))\,dt \\ \end{align*}\] <p>So</p> \[\begin{align} \int e^{at}\cos(bt)\,dt&amp;=\Re\left(\int e^{(a+bi)t}\,dt\right)\\ \int e^{at}\sin(bt)\,dt&amp;=\Im\left(\int e^{(a+bi)t}\,dt\right) \end{align}\] <p>Luckily, for these integrals, it’s easy to split the real and imaginary parts.</p> \[\begin{align*} \int e^{(a+bi)t}\,dt&amp;=\frac{e^{(a+bi)t}}{a+bi}\\ \int e^{(a+bi)t}\,dt&amp;=\frac{e^{at}e^{bit}(a-bi)}{a^2+b^2}\\ \int e^{(a+bi)t}\,dt&amp;=\frac{e^{at}(\cos(bt)+i\sin(bt))(a-bi)}{a^2+b^2}\\ \int e^{(a+bi)t}\,dt&amp;=\frac{e^{at}\left(a\cos(bt)+b\sin(bt)\right)}{a^2+b^2}+i\frac{e^{at}\left(a\sin(bt)-b\cos(bt)\right)}{a^2+b^2}\\ \end{align*}\] <p>And that’s it!</p> \[\begin{align} \int e^{at}\cos(bt)\,dt&amp;=\frac{e^{at}\left(a\cos(bt)+b\sin(bt)\right)}{a^2+b^2}+C\\ \int e^{at}\sin(bt)\,dt&amp;=\frac{e^{at}\left(a\sin(bt)-b\cos(bt)\right)}{a^2+b^2}+C\\ \end{align}\] <p>And while it may look like a mess at first, it’s actually relatively easy to remember once you know where each part comes from.</p> <p>First, both are multiplied by a common \(e^{at}\), which we would expect to stick around after integration, and the squared magnitude of the complex exponent \(a^2+b^2\), which always shows up when dividing by a complex number.</p> <p>But how would one remember the numerator terms? Well, when multiplying two complex numbers, the real part is always contains the product of the real parts and the product of the imaginary parts. Here the real parts were \(\cos(bt)\) and \(a\), and the imaginary parts \(\sin(bt)\) and \(b\). Normally, we subtract the product of the imaginary parts, but because we were <em>dividing</em> by \(a+bi\), we’re multiplying by the conjugate \(a-bi\), so we don’t need to subtract anything in evaluating the real part.</p> <p>Similarly, the imaginary part of a product of complex numbers is the sum of the real and imaginary parts cross multiplied. Since, again, we’re actually multiplying by the conjugate, we subtract that term with the imaginary part \(b\).</p> <p>If my rambling made no sense, then no worries. You may always just go through the process yourself at your own pace, and eventually you’ll notice the patterns that I take advantage of.</p> <p>Let’s do an example. Suppose we want to evaluate either of</p> \[\int e^{3t}\cos(4t)\,dt\quad\int e^{3t}\sin(4t)\,dt\] <p>Then to get either/both, we just need to integrate</p> \[\int e^{(3+4i)t}\,dt\] <p>This is easy enough.</p> \[\int e^{(3+4i)t}\,dt=\frac{e^{(3+4i)t}}{3+4i}\] <p>Now we know what’s going to happen. We’re going to get a \(\frac{e^{3t}}{25}\) multiplying everything because the real part is \(3\) and the magnitude squared of the exponent \(| 3+4i |^2=25\).</p> <p>Now to get the \(\cos\) integral, we need the real part of the product. So we’ll have \(\cos(4t)\) times the real part of the complex exponent \(3\) plus, since we’re multiplying by the conjugate, \(\sin(4t)\) times the imaginary part \(4\).</p> \[\int e^{3t}\cos(4t)\,dt=\frac{e^{3t}(3\cos(4t)+4\sin(4t))}{25}\] <p>For the \(\sin\) integral, we’ll get \(\cos(4t)\) times the negative of the imaginary part \(-4\) plus \(\sin(4t)\) times the real part \(3\).</p> \[\int e^{3t}\sin(4t)\,dt=\frac{e^{3t}(-4\cos(4t)+3\sin(4t))}{25}\] <p>If you want to see the full work, however, here it is.</p> \[\begin{align*} \int e^{(3+4i)t}\,dt&amp;=\frac{e^{(3+4i)t}}{3+4i}\\ \int e^{(3+4i)t}\,dt&amp;=\frac{e^{3t}e^{4it}(3-4i)}{3^2+4^2}\\ \int e^{(3+4i)t}\,dt&amp;=\frac{e^{3t}(\cos(4t)+i\sin(4t))(3-4i)}{25}\\ \int e^{(3+4i)t}\,dt&amp;=\frac{e^{3t}\left(3\cos(4t)+4\sin(4t)\right)}{25}+i\frac{e^{3t}\left(3\sin(4t)-4\cos(4t)\right)}{25}\\ \end{align*}\] \[\begin{align*} \int e^{3t}\cos(4t)\,dt&amp;=\frac{e^{3t}(3\cos(4t)+4\sin(4t))}{25}\\ \int e^{3t}\sin(4t)\,dt&amp;=\frac{e^{3t}(3\sin(4t)-4\cos(4t))}{25}\\ \end{align*}\] <h2 id="less-terrible-integration-by-parts">Less Terrible Integration by Parts</h2> <p>Now, consider the integral</p> \[\int f(t)e^{(a+bi)t}\,dt\] <p>where \(f(t)\) is a <em>real</em> function.</p> <p>We’re just going to do the same thing as we did above.</p> \[\begin{align*} \int f(t)e^{(a+bi)t}\,dt&amp;=\int f(t)e^{at}e^{i(bt)}\,dt \\ \int f(t)e^{(a+bi)t}\,dt&amp;=\int f(t)e^{at}(\cos(bt)+i\sin(bt))\,dt \\ \int f(t)e^{(a+bi)t}\,dt&amp;=\int\left[ f(t)e^{at}\cos(bt)+if(t)e^{at}\sin(bt))\right]\,dt \\ \int f(t)e^{(a+bi)t}\,dt&amp;=\int f(t)e^{at}\cos(bt)\,dt+\int if(t)e^{at}\sin(bt))\,dt \\ \end{align*}\] <p>Giving us</p> \[\begin{equation} \int f(t)e^{(a+bi)t}\,dt=\int f(t)e^{at}\cos(bt)\,dt+i\int f(t)e^{at}\sin(bt)\,dt \end{equation}\] <p>We can then say, once again,</p> \[\begin{align} \int f(t)e^{at}\cos(bt)\,dt&amp;=\Re\left(\int f(t)e^{(a+bi)t}\,dt\right)\\ \int f(t)e^{at}\sin(bt)\,dt&amp;=\Im\left(\int f(t)e^{(a+bi)t}\,dt\right) \end{align}\] <p>And now we can solve a <em>much</em> easier integral and get answer by covering up about half of the result. <em>Not to mention</em> that it solves it for both \(\sin\) <em>and</em> \(\cos\). So going back to the example above, by solving</p> \[I=\int t^2e^{(3+4i)t}\,dt\] <p>we will get both the answer to \(\int t^2e^{3t}\cos(4t)\,dt\) and \(\int t^2e^{3t}\sin(4t)\,dt\).</p> <p>This is an easy enough integral to solve by the tabular method.</p> \[\begin{array}{c|cc} &amp;\frac{d}{dt}&amp;\int\\ \hline +&amp;t^2&amp;e^{(3+4i)t}\\ -&amp;2t&amp;\frac{e^{(3+4i)t}}{3+4i}\\ +&amp;2&amp;\frac{e^{(3+4i)t}}{(3+4i)^2}\\ -&amp;0&amp;\frac{e^{(3+4i)t}}{(3+4i)^3} \end{array}\] \[I=t^2\frac{e^{(3+4i)t}}{3+4i}-2t\frac{e^{(3+4i)t}}{(3+4i)^2}+2\frac{e^{(3+4i)t}}{(3+4i)^3}\] \[I=e^{(3+4i)t}\frac{(3+4i)^2t^2-2(3+4i)t+2}{(3+4i)^3}\] <p>The difficult part is the complex arithmetic to isolate the real and imaginary parts of this expression. Doing that, however, requires no calculus. The arithmetic can also be done on most calculators.</p> \[\begin{gather*} \int t^2e^{(3+4i)t}\,dt=e^{(3+4i)t}\frac{(3+4i)^2t^2-2(3+4i)t+2}{(3+4i)^3}\\ I=e^{3t}e^{4it}\frac{(-7+24i)t^2-2(3+4i)t+2}{-117+44i}\\ I=e^{3t}(\cos(4t)+i\sin(4t))\frac{(1875-2500i)t^2+(350+1200i)t-(234+88i)}{(-117)^2+(44)^2}\\ I=\frac{e^{3t}\cos(4t)}{15625}\left((1875-2500i)t^2+(350+1200i)t-(234+88i)\right)\\ +\frac{e^{3t}\sin(4t)}{15625}\left((2500+1875i)t^2+(-1200+350i)t+(88-234i)\right)\\ I=\frac{e^{3t}}{15625}\left((1875t^2+350t-234)\cos(4t)+(2500t^2-1200t+88)\sin(4t) \right)\\ +i\frac{e^{3t}}{15625}\left((-2500t^2+1200t-88)\cos(4t)+(1875t^2+350t-234)\sin(4t) \right)+C \end{gather*}\] <p>So we obtain that (neglecting the \(+C\) to conserve space)</p> \[\begin{align} \int t^2e^{3t}\cos(4t)\,dt&amp;=\frac{e^{3t}}{15625}\left((1875t^2+350t-234)\cos(4t)+(2500t^2-1200t+88)\sin(4t) \right)\\ \int t^2e^{3t}\sin(4t)\,dt&amp;=\frac{e^{3t}}{15625}\left((-2500t^2+1200t-88)\cos(4t)+(1875t^2+350t-234)\sin(4t) \right) \end{align}\] <p>The arithmetic was a bit laborious, but not nearly as bad as doing the multiple looping integration by parts for both integrals, in my view.</p> <p>If we were looking specifically for \(\int t^2e^{3t}\cos(4t)\,dt\), we could have taken a shortcut through the last two steps by only taking the real parts obtained when multiplying through by \(\cos(4t)+i\sin(4t)\). That is to say, by defining \(p(t)=(2500+1875i)t^2+(-1200+350i)t+(88-234i)\),</p> \[\int t^2e^{3t}\cos(4t)\,dt=\frac{e^{3t}}{15625}\left(\Re(p(t))\cos(4t)-\Im(p(t))\sin(4t) \right)\] <p>If you are unsure how I got this, recall that that when multiplying two complex numbers, the real part is going to be the product of the real parts minus the product of the imaginary parts, since the \(i^2\) will negate the term. The products of the real and imaginary parts of each one will not be real, because there won’t be a second \(i\) term to cancel out the one from the imaginary part of origin. This extends to the product of complex functions too, as we used above.</p> <p>So using that we could have also skipped to get \(\int t^2e^{3t}\sin(4t)\,dt\) through</p> \[\int t^2e^{3t}\sin(4t)\,dt=\frac{e^{3t}}{15625}\left(\Im(p(t))\cos(4t)+\Re(p(t))\sin(4t) \right)\] <p>Only taking half the terms is <em>usually</em> what you’ll be doing when using this method, since it usually comes from wanting the answer to just one part, not both.</p> <p>Additionally, there’s no need to memorize the formulas like \(\Re(p(t))\cos(4t)-\Im(p(t))\sin(4t)\), just remember which part you want and multiply based on which terms will be in it.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: October 26, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>