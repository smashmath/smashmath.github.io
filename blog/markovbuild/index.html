<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Constructing 2x2 Markov Matrices | smashmath</title> <meta name="author" content=" "> <meta name="description" content="Build a Markov Chain with desired behavior."> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/markovbuild/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Constructing 2x2 Markov Matrices</h1> <p class="post-description">Build a Markov Chain with desired behavior.</p> </header> <article> <h2 id="what-we-want">What We Want</h2> <p>We are looking for a regular stochastic matrix \(M\) with all positive entries less than \(1\) such that the columns add up to \(1\). The ‘steady-state’ vector will be \(\vec{x}_f=(x_f,1-x_f)\), where \(0&lt; x_f&lt;1\), such that</p> <ol> <li> \[\begin{equation} M\vec{x}_f=\vec{x}_f \end{equation}\] </li> <li> \[\begin{equation} \lim_{k\to\infty}M^k\vec{x}_0=\vec{x}_f,\;\forall \;\vec{x}_0 \end{equation}\] </li> </ol> <p>So, essentially, we have a specific vector we want the system to converge to. That isn’t too difficult so let’s spice it up and get more specific. After \(n\) iterations, for any given initial state \(\vec{x}_0=(x_0,1-x_0)\) where \(0\leq x_0\leq1\), the system must be within an error of \(\varepsilon&gt;0\) from the equilibrium solution.</p> \[\begin{equation} |M^n\vec{x}_0-\vec{x}_f|\leq\varepsilon \end{equation}\] <p>The solution which we will derive is as follows.</p> <hr> <p>For a \(\lambda\) satisfying both</p> \[\begin{equation}\label{bounds} | \lambda |\leq \sqrt[\leftroot{-2}\uproot{2}n]{\frac{\varepsilon}{x_f\sqrt2}},\quad \lambda&gt;\frac{|2x_f-1|-1}{|2x_f-1|+1} \end{equation}\] <hr> <h2 id="the-matrix">The Matrix</h2> <p>\(M\) is given by both of the following expressions,</p> <hr> \[\begin{equation} \label{M2Sum} M= \begin{bmatrix}x_f\\1-x_f\end{bmatrix} \begin{bmatrix}1&amp;1\end{bmatrix}+ \lambda\begin{bmatrix}-1\\1\end{bmatrix} \begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \end{equation}\] \[\begin{equation}\label{M1Sum} M= I+(1-\lambda) \begin{bmatrix}1\\-1\end{bmatrix}\begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \end{equation}\] <hr> <p>The sign of \(\lambda\) will determine whether the system approaches the equilibrium directly or if it bounces around like an alternating series.</p> <p>Additionally, \(\vec{x}_n=M^n\vec{x}_0\) is given by</p> \[\begin{equation} \label{xn} M^n\vec{x}_0= \vec{x}_f + \lambda^n(x_f-x_0)\begin{bmatrix}-1\\1\end{bmatrix} \end{equation}\] <p>This looks exactly like what we want since</p> \[\lim_{n\to \infty}\lambda^n=0\] <p>if \(| \lambda |&lt;1\) leaving us with our steady state vector in the limit.</p> <h2 id="testing">Testing</h2> <p>Let’s take an example to see if it works.</p> <p>I want the equilibrium of the system to be \(\vec{x}_f=(0.75,0.25)\), and after \(4\) iterations I want the system to be within \(0.01\) from the equilibrium.</p> <p>That gives me</p> \[\begin{equation} | \lambda |\leq \sqrt[\leftroot{-2}\uproot{2}4]{\frac{0.01}{0.75\sqrt2}} \approx 0.3116,\quad \lambda &gt; -\frac{1}{3} \end{equation}\] <p>Let’s take \(\lambda=0.3\). That gives me</p> \[\begin{equation} M= I+(0.7) \begin{bmatrix}1\\-1\end{bmatrix}\begin{bmatrix}-0.25&amp;0.75\end{bmatrix}=\begin{bmatrix}0.825&amp;0.525\\0.175&amp;0.475\end{bmatrix} \end{equation}\] <p>We test our equilibrium vector,</p> \[\begin{equation} \begin{bmatrix}0.825&amp;0.525\\0.175&amp;0.475\end{bmatrix}\begin{bmatrix}0.75\\0.25\end{bmatrix}=\begin{bmatrix}0.75\\0.25\end{bmatrix} \end{equation}\] <p>Perfect. Now to maximize the error, \(x_0\) has to be either \(0\) or \(1\) (because based on equation \eqref{xn} we want to maximize \(| x_f-x_0 |\) where they are both between \(0\) and \(1\)). That means \(\vec{x}_0\) is either \((1,0)\) or \((0,1)\). Therefore, the \(\vec{x}_n\) furthest from the equilibrium vector will be one of the columns of \(M^n\). Thus, we can just raise \(M\) to the \(n\)th power and see how close each column is to \(\vec{x}_f\).</p> \[\begin{equation} M^4=\begin{bmatrix}0.752&amp;0.7439\\0.248&amp;0.2561\end{bmatrix} \end{equation}\] <p>The error of each column is \(\approx 0.00286,0.00859\) which are both absolutely within our desired error. Just to check, let’s see how far off \(\vec{x}_3\) is.</p> \[\begin{equation} M^3=\begin{bmatrix}0.7567&amp;0.7297\\0.2432&amp;0.2702\end{bmatrix} \end{equation}\] <p>The error here is \(\approx 0.0095,0.0286\), the latter of which it is not within our desired error. So we managed to set the rate of convergence to be just where we want it. In fact, we could get a lower bound on \(\lambda\) by substituting \(3\) into the upper bound expression in \eqref{bounds}. Since \(\lambda=-0.3\) also fits between our bounds, we could have used that to get a different matrix where the answer oscillates.</p> \[\begin{array}{c|ccccc} \lambda&amp;M^0&amp;M&amp;M^2&amp;M^3&amp;M^4\\ 0.3&amp;\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix} &amp;\begin{bmatrix}0.825&amp;0.525\\0.175&amp;0.475\end{bmatrix} &amp;\begin{bmatrix}0.7725&amp;0.6825\\0.2275&amp;0.3175\end{bmatrix} &amp;\begin{bmatrix}0.7567&amp;0.7297\\0.2432&amp;0.2702\end{bmatrix} &amp;\begin{bmatrix}0.7520&amp;0.7439\\0.2480&amp;0.2561\end{bmatrix}&amp;\hline\\ -0.3&amp;\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix} &amp;\begin{bmatrix}0.675&amp;0.975\\0.325&amp;0.025\end{bmatrix} &amp;\begin{bmatrix}0.7725&amp;0.6825\\0.2275&amp;0.3175\end{bmatrix} &amp;\begin{bmatrix}0.7433&amp;0.7703\\ 0.2567&amp; 0.2297\end{bmatrix} &amp;\begin{bmatrix}0.7520 &amp; 0.7439\\ 0.2480 &amp; 0.2561\end{bmatrix} \end{array}\] <p>Beautifully, they are the same for even \(n\), which is consistent with \eqref{xn}.</p> <h2 id="proof--derivation">Proof / Derivation</h2> <p>We start by using an incredibly useful fact:</p> <p>If \(v\) is an eigenvector of \(A\) with eigenvalue \(\lambda\), and if \(v'\) is an eigenvector of \(A^T\) with eigenvalue \(\lambda'\neq\lambda\), then</p> \[\begin{equation} v\cdot v'=0 \end{equation}\] <p>I encourage the reader to prove this.</p> <details> <summary>Hint</summary> Consider $$(v')^TAv$$ </details> <p>Now we also use the fact that \((1,1)\) is an eigenvector with eigenvalue \(1\) of \(M^T\) because the columns of \(M\) add up to \(1\).</p> <p>Therefore, \((-1,1)\) is an eigenvector of \(M\) with an eigenvalue that is <em>not</em> \(1\) (let’s say \(\lambda\)).</p> <p>Since we want \((x_f,1-x_f)\) (which is linearly independent of \((-1,1)\) if \(0&lt; x_f&lt;1\)) to be an eigenvector with eigenvalue \(1\), we have a basis of eigenvectors and everything we need to construct a diagonalization of \(M\).</p> \[\begin{equation} M=\begin{bmatrix}x_f&amp;-1\\1-x_f&amp;1\end{bmatrix} \begin{bmatrix}1&amp;0\\0&amp;\lambda\end{bmatrix}\begin{bmatrix}x_f&amp;-1\\1-x_f&amp;1\end{bmatrix}^{-1} \end{equation}\] <p>To get \eqref{M2Sum} we just write the center matrix as</p> \[\begin{equation} \begin{bmatrix}1&amp;0\\0&amp;\lambda\end{bmatrix}=e_1e_1^T+\lambda e_2e_2^T \end{equation}\] <p>Then we just distribute the matrices on the left and right.</p> <p>For \eqref{M1Sum}, we simplify calculating by removing an \(I\) from \(M\).</p> \[\begin{equation} M=I+\begin{bmatrix}x_f&amp;-1\\1-x_f&amp;1\end{bmatrix} \begin{bmatrix}0&amp;0\\0&amp;\lambda-1\end{bmatrix}\begin{bmatrix}x_f&amp;-1\\1-x_f&amp;1\end{bmatrix}^{-1} \end{equation}\] <p>Big brain row/column perspective tells us that we want \((\lambda-1)\) of the second column of the eigenvector matrix times the second row of its inverse.</p> \[\begin{equation} M=I+(\lambda-1)\begin{bmatrix}-1\\1\end{bmatrix} \begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \end{equation}\] <p>\(\lambda-1\) is always negative, so just to make it nice we negate both it and the column vector to get \eqref{M1Sum}.</p> <p>To prove \eqref{xn} we use the wonderful properties of diagonalization \(M^n=PD^nP^{-1}\) and do the same steps that we did to get \eqref{M2Sum} to say that</p> \[\begin{equation} M^n= \begin{bmatrix}x_f\\1-x_f\end{bmatrix} \begin{bmatrix}1&amp;1\end{bmatrix}+ \lambda^n\begin{bmatrix}-1\\1\end{bmatrix} \begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \end{equation}\] <p>Multiply on the right by \(\vec{x}_0=(x_0,1-x_0)\),</p> \[\begin{equation} M^n\vec{x}_0= \begin{bmatrix}x_f\\1-x_f\end{bmatrix} \begin{bmatrix}1&amp;1\end{bmatrix} \begin{bmatrix}x_0\\1-x_0\end{bmatrix}+ \lambda^n\begin{bmatrix}-1\\1\end{bmatrix} \begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \begin{bmatrix}x_0\\1-x_0\end{bmatrix} \end{equation}\] \[\begin{equation} M^n\vec{x}_0= \begin{bmatrix}x_f\\1-x_f\end{bmatrix}+ \lambda^n(x_f-x_0)\begin{bmatrix}-1\\1\end{bmatrix} \end{equation}\] <p>Leaving us with \eqref{xn}.</p> <p>Now to get the bounds on \(\lambda\), we examine \(| M^n\vec{x}_0-\vec{x}_f | &lt;\varepsilon\),</p> \[\begin{gather} | M^n\vec{x}_0-\vec{x}_f | &lt;\varepsilon\\ \left| \vec{x}_f+\lambda^n(x_f-x_0)\begin{bmatrix}-1\\1\end{bmatrix}-\vec{x}_f \right| &lt;\varepsilon\\ \left| \lambda^n(x_f-x_0)\begin{bmatrix}-1\\1\end{bmatrix} \right| &lt;\varepsilon\\ | \lambda^n(x_f-x_0) |\left| \begin{bmatrix}-1\\1\end{bmatrix} \right| &lt;\varepsilon\\ | \lambda|^n |x_f-x_0| \sqrt2 &lt;\varepsilon\\ | \lambda|^n |x_f-x_0| &lt;\frac{\varepsilon}{\sqrt2}\\ \end{gather}\] <p>Now we observe that the maximum value of \(| x_f-x_0 |\) is \(x_f\) given our constraints on \(x_0\) and \(x_f\) to be between zero and one. Therefore, to maximize the distance, \(x_0\) would have to be either of the bounds, zero or one. Substituting \(| x_f-x_0 |=x_f\) and dividing it over,</p> \[\begin{equation} | \lambda|^n &lt;\frac{\varepsilon}{x_f\sqrt2} \end{equation}\] <p>By taking the \(n\)-th root, we get the first part (upper bound) of \eqref{bounds}.</p> <p>Now to get the lower bound, we make sure the entries of \(M\) satisfy \(0&lt; M_{ij}&lt;1\). We need only ensure one entry in each column, as \(0&lt; M_{ij}&lt;1\implies 0&lt; 1-M_{ij}&lt;1\). So we choose to look at \(M_{12}\) and \(M_{21}\) because it’ll be just slightly easier.</p> \[\begin{gather} M_{12}=e_1^TMe_2\\ 0&lt; e_1^TMe_2&lt;1\\ 0&lt; e_1^T\left( I+(\lambda-1)\begin{bmatrix}-1\\1\end{bmatrix} \begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \right)e_2&lt;1\\ 0&lt; 0+(\lambda-1)(-1)(x_f)&lt;1\\ -\frac{1}{x_f}&lt; \lambda-1&lt;0\\ 1-\frac{1}{x_f}&lt; \lambda&lt;1\\ \left(1-\frac{1}{x_f}\right)^{1}&lt; \lambda&lt;1\\ \end{gather}\] <p>hhhh</p> \[\begin{gather} M_{21}=e_2^TMe_1\\ 0&lt; e_2^TMe_1&lt;1\\ 0&lt; e_2^T\left( I+(\lambda-1)\begin{bmatrix}-1\\1\end{bmatrix} \begin{bmatrix}x_f-1&amp;x_f\end{bmatrix} \right)e_1&lt;1\\ 0&lt; 0+(\lambda-1)(1)(x_f-1)&lt;1 \end{gather}\] <p>We know that \(x_f-1&lt; 0\) so we flip the inequality.</p> \[\begin{gather} -\frac{1}{1-x_f}&lt; \lambda-1&lt;0\\ 1-\frac{1}{1-x_f}&lt; \lambda&lt;1\\ \left(1-\frac{1}{x_f}\right)^{-1}&lt; \lambda&lt;1\\ \end{gather}\] <p>Therefore, for a lower bound on \(\lambda\),</p> \[\begin{equation} \left(1-\frac{1}{x_f}\right)^{\pm1}&lt; \lambda \end{equation}\] <p>We can simplify this, however. The following are equivalent expressions:</p> \[\begin{equation} \left(1-\frac{1}{x_f}\right)^{\pm1}&lt; \lambda \implies \frac{|2x_f-1|-1}{|2x_f-1|+1} &lt; \lambda \end{equation}\] <p>concluding the proof of \eqref{bounds}.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: November 12, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>