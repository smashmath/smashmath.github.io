<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Matrix Exponentials Using Differential Equations | smashmath</title> <meta name="author" content=" "> <meta name="description" content="ok"> <meta name="keywords" content="math, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smashmath.github.io/blog/matrixexpwde/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">smashmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Matrix Exponentials Using Differential Equations</h1> <p class="post-description">ok</p> </header> <article> <p>Yet another impractical way to calculate matrix exponentials found by yours truly. This method requires</p> <ol> <li>Finding the characteristic/minimal polynomial (and its roots)</li> <li>Calculating powers of the matrix</li> <li>Finding solutions to a linear constant coefficient differential equation for which you know the roots of the characteristic polynomial</li> <li>Finding the <a href="../normalized/" target="_blank">normalized solutions</a> of said differential equation</li> </ol> <p>You may wonder why you would ever use this method when finding the eigenvectors requires fewer steps. However, it does somewhat simplify the cases of defective and complex eigenvalues, and changes the computation into one that is more familiar and approachable. In short: more easier steps.</p> <p>EDIT 12/8/21: This is actually very convinient for \(2\times2\) matrices. <a href="../2x2ezmatrixexp/" target="_blank">For more details.</a></p> <hr> <p>Suppose \(A\) is an \(n\times n\) matrix and \(p(t)=\det(tI-A)\) is its minimal polynomial.</p> <p>Next given that \(Y_1(t),\ldots,Y_n(t)\) are the solutions to the linear constant coefficient differential equation \(p(D)y=0\) such that the Wronskian \(W[Y_1,\ldots,Y_n] (t)\) evaluated at \(t=0\) is the identity matrix, where \(D\) is the differential operator such that \(Dy=y'\). That is to say \(Y_1(t),\ldots,Y_n(t)\) are the <a href="../normalized/" target="_blank">normalized solutions</a> of \(p(D)y=0\).</p> <p>It follows then that</p> \[\begin{equation} e^{At}=\sum_{k=1}^nY_k(t)A^{k-1} \end{equation}\] <h3 id="proof">Proof:</h3> <p>Assuming the givens above, let</p> \[\begin{align} \Psi(t)&amp;=\sum_{k=1}^nY_k(t)A^{k-1}\\ \Phi(t)&amp;=e^{At} \end{align}\] <p>Because \(Y_1(t),\ldots,Y_n(t)\) are all solutions to \(p(D)y=0\), by linearity \(\Psi(t)\) is also a solution \(p(D)\Psi(t)=0\).</p> <p>It follows that because \(W[Y_1,\ldots,Y_n] (0)=I\), we have that for \(0\leq m&lt; n\)</p> \[Y_k^{(m)}(0)= \begin{cases} 1,&amp;m=k-1\\ 0,&amp;m\neq k-1 \end{cases}\] <p>Therefore, \(\Psi(t)\) also solves the initial value problem</p> \[\begin{equation} p(D)\Psi=0,\quad \Psi(0)=I,\Psi'(0)=A,\ldots,\Psi^{(n-1)}(0)=A^{n-1} \end{equation}\] <p>Essentially, we are talking about \(n^2\) initial value problems, and just putting all of them into a matrix.</p> <p>Next we examine \(\Phi(t)=e^{At}\).</p> <p>\(\Phi'(t)=Ae^{At}=A\Phi(t)\). It immediately follows that</p> \[\begin{equation}\label{mth} \Phi^{(m)}(t)=A^m\Phi(t) \end{equation}\] <p>Alternatively, one can write this as \(D^m\Phi(t)=A^m\Phi(t)\). By linearity, this then implies that</p> \[\begin{equation} p(D)\Phi(t)=p(A)\Phi(t) \end{equation}\] <p>By the Cayley-Hamilton theorem, \(p(A)=0\). So \(\Phi(t)\) is a solution to \(p(D)\Phi=0\).</p> <p>The fact that \(\Phi(0)=I\) along with \eqref{mth} implies \(\Phi^{(m)}(0)=A^m\).</p> <p>Therefore, \(\Phi(t)\) is also a solution to the initial value problem</p> \[\begin{equation} p(D)\Phi=0,\quad \Phi(0)=I,\Phi'(0)=A,\ldots,\Phi^{(n-1)}(0)=A^{n-1} \end{equation}\] <p>By the Existence and Uniqueness theorem, \(\Phi\) and \(\Psi\) must be the same. Therefore,</p> \[\begin{equation} e^{At}=\sum_{k=1}^nY_k(t)A^{k-1}\quad \blacksquare \end{equation}\] <p>We can invoke the Existence and Uniqueness theorem for each of the \(n^2\) intial value problems, so this is valid.</p> <h3 id="example">Example</h3> <p>Take the matrix \(A=\begin{bmatrix}1&amp;-1&amp;0\\1&amp;0&amp;-1\\0&amp;1&amp;-1\end{bmatrix}\).</p> <p>We can find its characteristic polynomial with the formula \(p(t)=\lambda^3-\operatorname{tr}(A)\lambda^2+(C_{11}+C_{22}+C_{33})\lambda-\det(A)\) (where \(C_{ij}\) is the cofactor of the \(ij\) entry of \(A\)). With a trace and determinant of zero, and the cofactors adding up to 1, we obtain.</p> \[\lambda^3+\lambda=0\] <p>We now examine the differential equation with this characteristic polynomial:</p> \[y'''+y'=0\] <p>Factoring the characteristic polynomial gives us the roots \(\lambda=0,\pm i\). Therefore, a fundamental set of solutions is given by</p> \[y_1=1,y_2=\cos(t),y_3=\sin(t)\] <p>To find the normalized solutions at a given point \(t=t_0\), we may use the nifty property that</p> \[\begin{equation} W[y_1,\ldots,y_n] (t)W[y_1,\ldots,y_n] (t_0)^{-1}=W[Y_1,\ldots,Y_n] (t) \end{equation}\] <p>For our problem,</p> \[W[y_1,y_2,y_3] (t)=\begin{bmatrix}1&amp;\cos(t)&amp;\sin(t)\\0&amp;-\sin(t)&amp;\cos(t)\\0&amp;-\cos(t)&amp;-\sin(t)\end{bmatrix}\] <p>And</p> \[W[y_1,y_2,y_3] (0)=\begin{bmatrix}1&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;-1&amp;0\end{bmatrix} \implies W[y_1,y_2,y_3](0)^{-1} =\begin{bmatrix}1&amp;0&amp;1\\0&amp;0&amp;-1\\0&amp;1&amp;0\end{bmatrix}\] <p>Therefore,</p> \[\begin{bmatrix}1&amp;\cos(t)&amp;\sin(t)\\0&amp;-\sin(t)&amp;\cos(t)\\0&amp;-\cos(t)&amp;-\sin(t)\end{bmatrix}\begin{bmatrix}1&amp;0&amp;1\\0&amp;0&amp;-1\\0&amp;1&amp;0\end{bmatrix}=W[Y_1,\ldots,Y_n] (t)\] \[\begin{bmatrix}1&amp;\sin(t)&amp;1-\cos(t)\\0&amp;\cos(t)&amp;\sin(t)\\0&amp;-\sin(t)&amp;\cos(t)\end{bmatrix}=W[Y_1,\ldots,Y_n] (t)\] <p>The first row gives us the normalized solutions themselves, making them</p> \[Y_1=1,Y_2=\sin(t),Y_3=1-\cos(t)\] <p>Then, according to my derivation, we should find that</p> \[e^{At}=1I+\sin(t)A+(1-\cos(t))A^2\] \[e^{At}=I+\sin(t)\begin{bmatrix}1&amp;-1&amp;0\\1&amp;0&amp;-1\\0&amp;1&amp;-1\end{bmatrix}+(1-\cos(t)\begin{bmatrix}0&amp;-1&amp;1\\1&amp;-2&amp;1\\1&amp;-1&amp;0\end{bmatrix}\] \[e^{At}=\begin{bmatrix}1+\sin(t)&amp;-1-\sin(t)+\cos(t)&amp;1-\cos(t)\\1+\sin(t)-\cos(t)&amp;-1+2\cos(t)&amp;1-\sin(t)-\cos(t)\\1-\cos(t)&amp;-1+\sin(t)+\cos(t)&amp;1-\sin(t)\end{bmatrix}\] <p>Which is indeed the correct answer!</p> <p>As a side note, one may also utilize \(W[y_1,\ldots,y_n] (t_0)^{-1}\) to separate the parts by the original fundamental set of solutions rather than the normalized one.</p> <p>So for our example,</p> \[W[y_1,y_2,y_3] (0)^{-1}=\begin{bmatrix}1&amp;0&amp;1\\0&amp;0&amp;-1\\0&amp;1&amp;0\end{bmatrix}\] <p>The first row of \(W[y_1,y_2,y_3] (0)^{-1}\) was \((1,0,1)\) telling us that the part of \(e^{At}\) multiplied by \(y_1=1\) is \(I+A^2\).</p> <p>The second row being \((0,0,-1)\) tells us that the part of \(e^{At}\) multiplied by \(y_2=\cos(t)\) is \(-A^2\).</p> <p>Finally, the third row is \((0,1,0)\), so the part of \(e^{At}\) multiplied by \(\sin(t)\) is simply \(A\).</p> <p>This is my preferred way to calculate it, since the combining of like terms is done beforehand.</p> <h3 id="another-example">Another example</h3> <p>Suppose that \(A=\begin{bmatrix}0&amp;2&amp;-1\\-1&amp;3&amp;-1\\0&amp;1&amp;0\end{bmatrix}\).</p> <p>The characteristic polynomial is \(\lambda^3-3\lambda^2+3\lambda-1=(\lambda-1)^3\). Which unfortunately means we have a defective eigenvalue.</p> <p>However, we don’t need to worry ourselves with generalized eigenvectors. Instead, we find our fundamental set of solutions to the differential equation</p> \[y'''-3y''+3y'-y=0\] <p>Since we know the characteristic polynomial factors into \((\lambda-1)^3\), we know we have a repeated root giving the set of solutions</p> \[y_1=e^t,y_2=te^t,y_3=t^2e^t\] <p>The Wronskian of those solutions is</p> \[W[y_1,y_2,y_3] (t)=\begin{bmatrix}e^t&amp;te^t&amp;t^2e^t\\e^t&amp;(t+1)e^t&amp;(t^2+2t)e^t\\e^t&amp;(t+2)e^t&amp;(t^2+4t+2)e^t\end{bmatrix}\] \[W[y_1,y_2,y_3] (t)=e^t\begin{bmatrix}1&amp;t&amp;t^2\\1&amp;t+1&amp;t^2+2t\\1&amp;t+2&amp;t^2+4t+2\end{bmatrix}\] <p>evaluating the Wronskian at \(t=0\)</p> \[W[y_1,y_2,y_3] (0)=\begin{bmatrix}1&amp;0&amp;0\\1&amp;1&amp;0\\1&amp;2&amp;2\end{bmatrix} \implies W[y_1,y_2,y_3] (0)^{-1}=\begin{bmatrix}1&amp;0&amp;0\\-1&amp;1&amp;0\\\frac{1}{2}&amp;-1&amp;\frac{1}{2}\end{bmatrix}\] <p>We now read the rows of \(W[y_1,y_2,y_3] (0)^{-1}\) to get \(e^{At}\):</p> \[e^{At}=e^tI+te^t(A-I)+t^2e^t\left(\frac{1}{2}I-A+\frac{1}{2}A^2\right)\] \[e^{At}=e^t\left(I+t(A-I)+\frac{1}{2}t^2\left(I-2A+A^2\right)\right)\] \[e^{At}=e^t\left(I+t(A-I)+\frac{1}{2}t^2\left(A-I\right)^2\right)\] <p>Computing \(A^2\) to be \(A^2=\begin{bmatrix}-2&amp;5&amp;-2\\-3&amp;6&amp;-2\\-1&amp;3&amp;-1\end{bmatrix}\), we evaluate the following</p> \[\begin{align*} I&amp;=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix}\\ A-I&amp;=\begin{bmatrix}-1&amp;2&amp;-1\\-1&amp;2&amp;-1\\0&amp;1&amp;-1\end{bmatrix}\\ \frac{1}{2}(A-I)^2&amp;=\frac{1}{2}\begin{bmatrix}-1&amp;-2&amp;0\\-1&amp;1&amp;0\\-1&amp;1&amp;0\end{bmatrix} \end{align*}\] <p>Adding it all up we obtain</p> \[e^{At}=e^t\begin{bmatrix}1-t-\frac{1}{2}t^2&amp;2t-t^2&amp;-t\\-t-\frac{1}{2}t^2&amp;1+2t+\frac{1}{2}t^2&amp;-t\\-\frac{1}{2}t^2&amp;t+\frac{1}{2}t^2&amp;1-t\end{bmatrix}\] </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 29, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>